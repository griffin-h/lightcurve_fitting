<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>API Documentation &mdash; Light Curve Fitting 0.8.0.post1+ge77e541 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/plot_directive.css" type="text/css" />
      <link rel="stylesheet" href="_static/copybutton.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script src="_static/clipboard.min.js"></script>
        <script src="_static/copybutton.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release History" href="release-history.html" />
    <link rel="prev" title="Usage" href="usage.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            Light Curve Fitting
          </a>
              <div class="version">
                0.8.0.post1+ge77e541
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="usage.html">Usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-lightcurve_fitting.bolometric">lightcurve_fitting.bolometric module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.blackbody_lstsq"><code class="docutils literal notranslate"><span class="pre">blackbody_lstsq()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.calc_colors"><code class="docutils literal notranslate"><span class="pre">calc_colors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.calculate_bolometric"><code class="docutils literal notranslate"><span class="pre">calculate_bolometric()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.group_by_epoch"><code class="docutils literal notranslate"><span class="pre">group_by_epoch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.integrate_sed"><code class="docutils literal notranslate"><span class="pre">integrate_sed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.median_and_unc"><code class="docutils literal notranslate"><span class="pre">median_and_unc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.plot_bolometric_results"><code class="docutils literal notranslate"><span class="pre">plot_bolometric_results()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.plot_chain"><code class="docutils literal notranslate"><span class="pre">plot_chain()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.plot_color_curves"><code class="docutils literal notranslate"><span class="pre">plot_color_curves()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.pseudo"><code class="docutils literal notranslate"><span class="pre">pseudo()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.spectrum_corner"><code class="docutils literal notranslate"><span class="pre">spectrum_corner()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.spectrum_mcmc"><code class="docutils literal notranslate"><span class="pre">spectrum_mcmc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.bolometric.stefan_boltzmann"><code class="docutils literal notranslate"><span class="pre">stefan_boltzmann()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightcurve_fitting.filters">lightcurve_fitting.filters module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.filters.Filter"><code class="docutils literal notranslate"><span class="pre">Filter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.dfreq"><code class="docutils literal notranslate"><span class="pre">Filter.dfreq</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.dwl"><code class="docutils literal notranslate"><span class="pre">Filter.dwl</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.extinction"><code class="docutils literal notranslate"><span class="pre">Filter.extinction()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.freq_eff"><code class="docutils literal notranslate"><span class="pre">Filter.freq_eff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.freq_range"><code class="docutils literal notranslate"><span class="pre">Filter.freq_range</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.order"><code class="docutils literal notranslate"><span class="pre">Filter.order</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.read_curve"><code class="docutils literal notranslate"><span class="pre">Filter.read_curve()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.spectrum"><code class="docutils literal notranslate"><span class="pre">Filter.spectrum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.synthesize"><code class="docutils literal notranslate"><span class="pre">Filter.synthesize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.trans"><code class="docutils literal notranslate"><span class="pre">Filter.trans</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.wl_eff"><code class="docutils literal notranslate"><span class="pre">Filter.wl_eff</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.filters.Filter.wl_range"><code class="docutils literal notranslate"><span class="pre">Filter.wl_range</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.filters.extinction_law"><code class="docutils literal notranslate"><span class="pre">extinction_law()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightcurve_fitting.fitting">lightcurve_fitting.fitting module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.fitting.format_credible_interval"><code class="docutils literal notranslate"><span class="pre">format_credible_interval()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.fitting.lightcurve_corner"><code class="docutils literal notranslate"><span class="pre">lightcurve_corner()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.fitting.lightcurve_mcmc"><code class="docutils literal notranslate"><span class="pre">lightcurve_mcmc()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.fitting.lightcurve_model_plot"><code class="docutils literal notranslate"><span class="pre">lightcurve_model_plot()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightcurve_fitting.lightcurve">lightcurve_fitting.lightcurve module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.lightcurve.Arrow"><code class="docutils literal notranslate"><span class="pre">Arrow</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC"><code class="docutils literal notranslate"><span class="pre">LC</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.bin"><code class="docutils literal notranslate"><span class="pre">LC.bin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.calcAbsMag"><code class="docutils literal notranslate"><span class="pre">LC.calcAbsMag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.calcFlux"><code class="docutils literal notranslate"><span class="pre">LC.calcFlux()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.calcLum"><code class="docutils literal notranslate"><span class="pre">LC.calcLum()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.calcMag"><code class="docutils literal notranslate"><span class="pre">LC.calcMag()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.calcPhase"><code class="docutils literal notranslate"><span class="pre">LC.calcPhase()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.filters_to_objects"><code class="docutils literal notranslate"><span class="pre">LC.filters_to_objects()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.findNondet"><code class="docutils literal notranslate"><span class="pre">LC.findNondet()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.findPeak"><code class="docutils literal notranslate"><span class="pre">LC.findPeak()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.get"><code class="docutils literal notranslate"><span class="pre">LC.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.normalize_column_names"><code class="docutils literal notranslate"><span class="pre">LC.normalize_column_names()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.plot"><code class="docutils literal notranslate"><span class="pre">LC.plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.read"><code class="docutils literal notranslate"><span class="pre">LC.read()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.where"><code class="docutils literal notranslate"><span class="pre">LC.where()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.write"><code class="docutils literal notranslate"><span class="pre">LC.write()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.lightcurve.LC.zp"><code class="docutils literal notranslate"><span class="pre">LC.zp</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.lightcurve.aux_axes"><code class="docutils literal notranslate"><span class="pre">aux_axes()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.lightcurve.binflux"><code class="docutils literal notranslate"><span class="pre">binflux()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.lightcurve.custom_legend"><code class="docutils literal notranslate"><span class="pre">custom_legend()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.lightcurve.filter_legend"><code class="docutils literal notranslate"><span class="pre">filter_legend()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.lightcurve.filtsetup"><code class="docutils literal notranslate"><span class="pre">filtsetup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.lightcurve.flux2mag"><code class="docutils literal notranslate"><span class="pre">flux2mag()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.lightcurve.mag2flux"><code class="docutils literal notranslate"><span class="pre">mag2flux()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightcurve_fitting.models">lightcurve_fitting.models module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.BaseCompanionShocking"><code class="docutils literal notranslate"><span class="pre">BaseCompanionShocking</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.BaseCompanionShocking.companion_shocking"><code class="docutils literal notranslate"><span class="pre">BaseCompanionShocking.companion_shocking()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.BaseCompanionShocking.evaluate"><code class="docutils literal notranslate"><span class="pre">BaseCompanionShocking.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.BaseCompanionShocking.stretched_sifto"><code class="docutils literal notranslate"><span class="pre">BaseCompanionShocking.stretched_sifto()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.BaseCompanionShocking.t_max"><code class="docutils literal notranslate"><span class="pre">BaseCompanionShocking.t_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.BaseCompanionShocking.t_min"><code class="docutils literal notranslate"><span class="pre">BaseCompanionShocking.t_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.BaseCompanionShocking.temperature_radius"><code class="docutils literal notranslate"><span class="pre">BaseCompanionShocking.temperature_radius()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.BaseShockCooling"><code class="docutils literal notranslate"><span class="pre">BaseShockCooling</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.BaseShockCooling.evaluate"><code class="docutils literal notranslate"><span class="pre">BaseShockCooling.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.BaseShockCooling.t_max"><code class="docutils literal notranslate"><span class="pre">BaseShockCooling.t_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.BaseShockCooling.t_min"><code class="docutils literal notranslate"><span class="pre">BaseShockCooling.t_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.BaseShockCooling.temperature_radius"><code class="docutils literal notranslate"><span class="pre">BaseShockCooling.temperature_radius()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking"><code class="docutils literal notranslate"><span class="pre">CompanionShocking</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking.evaluate"><code class="docutils literal notranslate"><span class="pre">CompanionShocking.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking.input_names"><code class="docutils literal notranslate"><span class="pre">CompanionShocking.input_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking.units"><code class="docutils literal notranslate"><span class="pre">CompanionShocking.units</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking2"><code class="docutils literal notranslate"><span class="pre">CompanionShocking2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking2.evaluate"><code class="docutils literal notranslate"><span class="pre">CompanionShocking2.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking2.input_names"><code class="docutils literal notranslate"><span class="pre">CompanionShocking2.input_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking2.units"><code class="docutils literal notranslate"><span class="pre">CompanionShocking2.units</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking3"><code class="docutils literal notranslate"><span class="pre">CompanionShocking3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking3.evaluate"><code class="docutils literal notranslate"><span class="pre">CompanionShocking3.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking3.input_names"><code class="docutils literal notranslate"><span class="pre">CompanionShocking3.input_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking3.units"><code class="docutils literal notranslate"><span class="pre">CompanionShocking3.units</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.GaussianPrior"><code class="docutils literal notranslate"><span class="pre">GaussianPrior</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.GaussianPrior.logp"><code class="docutils literal notranslate"><span class="pre">GaussianPrior.logp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.LogUniformPrior"><code class="docutils literal notranslate"><span class="pre">LogUniformPrior</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.LogUniformPrior.logp"><code class="docutils literal notranslate"><span class="pre">LogUniformPrior.logp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.Model"><code class="docutils literal notranslate"><span class="pre">Model</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.Model.axis_labels"><code class="docutils literal notranslate"><span class="pre">Model.axis_labels</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.Model.evaluate"><code class="docutils literal notranslate"><span class="pre">Model.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.Model.input_names"><code class="docutils literal notranslate"><span class="pre">Model.input_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.Model.log_likelihood"><code class="docutils literal notranslate"><span class="pre">Model.log_likelihood()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.Model.nparams"><code class="docutils literal notranslate"><span class="pre">Model.nparams</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.Model.output_quantity"><code class="docutils literal notranslate"><span class="pre">Model.output_quantity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.Model.units"><code class="docutils literal notranslate"><span class="pre">Model.units</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.Prior"><code class="docutils literal notranslate"><span class="pre">Prior</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.Prior.logp"><code class="docutils literal notranslate"><span class="pre">Prior.logp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling"><code class="docutils literal notranslate"><span class="pre">ShockCooling</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling.evaluate"><code class="docutils literal notranslate"><span class="pre">ShockCooling.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling.input_names"><code class="docutils literal notranslate"><span class="pre">ShockCooling.input_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling.units"><code class="docutils literal notranslate"><span class="pre">ShockCooling.units</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling2"><code class="docutils literal notranslate"><span class="pre">ShockCooling2</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling2.evaluate"><code class="docutils literal notranslate"><span class="pre">ShockCooling2.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling2.input_names"><code class="docutils literal notranslate"><span class="pre">ShockCooling2.input_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling2.t_max"><code class="docutils literal notranslate"><span class="pre">ShockCooling2.t_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling2.t_min"><code class="docutils literal notranslate"><span class="pre">ShockCooling2.t_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling2.units"><code class="docutils literal notranslate"><span class="pre">ShockCooling2.units</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling3"><code class="docutils literal notranslate"><span class="pre">ShockCooling3</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling3.evaluate"><code class="docutils literal notranslate"><span class="pre">ShockCooling3.evaluate()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling3.input_names"><code class="docutils literal notranslate"><span class="pre">ShockCooling3.input_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling3.output_quantity"><code class="docutils literal notranslate"><span class="pre">ShockCooling3.output_quantity</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling3.t_max"><code class="docutils literal notranslate"><span class="pre">ShockCooling3.t_max()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling3.t_min"><code class="docutils literal notranslate"><span class="pre">ShockCooling3.t_min()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.ShockCooling3.units"><code class="docutils literal notranslate"><span class="pre">ShockCooling3.units</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.UniformPrior"><code class="docutils literal notranslate"><span class="pre">UniformPrior</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#lightcurve_fitting.models.UniformPrior.logp"><code class="docutils literal notranslate"><span class="pre">UniformPrior.logp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.blackbody_to_filters"><code class="docutils literal notranslate"><span class="pre">blackbody_to_filters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.format_unit"><code class="docutils literal notranslate"><span class="pre">format_unit()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.planck"><code class="docutils literal notranslate"><span class="pre">planck()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.planck_fast"><code class="docutils literal notranslate"><span class="pre">planck_fast()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.models.power"><code class="docutils literal notranslate"><span class="pre">power()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-lightcurve_fitting.speccal">lightcurve_fitting.speccal module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.speccal.calibrate_spectra"><code class="docutils literal notranslate"><span class="pre">calibrate_spectra()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.speccal.convert_spectrum_units"><code class="docutils literal notranslate"><span class="pre">convert_spectrum_units()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.speccal.create_wiserep_tsv"><code class="docutils literal notranslate"><span class="pre">create_wiserep_tsv()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.speccal.readOSCspec"><code class="docutils literal notranslate"><span class="pre">readOSCspec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.speccal.readfitsspec"><code class="docutils literal notranslate"><span class="pre">readfitsspec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.speccal.readspec"><code class="docutils literal notranslate"><span class="pre">readspec()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.speccal.remove_duplicate_wcs"><code class="docutils literal notranslate"><span class="pre">remove_duplicate_wcs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#lightcurve_fitting.speccal.removebadcards"><code class="docutils literal notranslate"><span class="pre">removebadcards()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="release-history.html">Release History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Light Curve Fitting</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">API Documentation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/api.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="api-documentation">
<h1>API Documentation<a class="headerlink" href="#api-documentation" title="Permalink to this heading">¶</a></h1>
<section id="module-lightcurve_fitting.bolometric">
<span id="lightcurve-fitting-bolometric-module"></span><h2>lightcurve_fitting.bolometric module<a class="headerlink" href="#module-lightcurve_fitting.bolometric" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.blackbody_lstsq">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">blackbody_lstsq</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1.0,</span> <span class="pre">100.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R_range</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.01,</span> <span class="pre">1000.0)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#blackbody_lstsq"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.blackbody_lstsq" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit a blackbody spectrum to a spectral energy distribution using <span class="math notranslate nohighlight">\(χ^2\)</span> minimization</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>epoch1</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>A single “epoch” of photometry that defines the observed spectral energy distribution</p>
</dd>
<dt><strong>z</strong><span class="classifier">float</span></dt><dd><p>Redshift between the blackbody (rest frame) and the filters (observed frame)</p>
</dd>
<dt><strong>p0</strong><span class="classifier">list, tuple, array-like, optional</span></dt><dd><p>Initial guess for [temperature (kK), radius (1000 Rsun)]. Default: <code class="docutils literal notranslate"><span class="pre">[10.,</span> <span class="pre">10.]</span></code></p>
</dd>
<dt><strong>T_range</strong><span class="classifier">tuple, list, array-like, optional</span></dt><dd><p>Range of allowed temperatures (in kilokelvins) in the prior. Default: <code class="docutils literal notranslate"><span class="pre">(1.,</span> <span class="pre">100.)</span></code></p>
</dd>
<dt><strong>R_range</strong><span class="classifier">tuple, list, array-like, optional</span></dt><dd><p>Range of allowed radii (in 1000 solar radii) in the prior. Default: <code class="docutils literal notranslate"><span class="pre">(0.01,</span> <span class="pre">1000.)</span></code></p>
</dd>
<dt><strong>cutoff_freq</strong><span class="classifier">float, optional</span></dt><dd><p>Cutoff frequency (in terahertz) for a modified blackbody spectrum (see <a class="reference external" href="https://doi.org/10.3847/1538-4357/aa9334">https://doi.org/10.3847/1538-4357/aa9334</a>)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>temp</strong><span class="classifier">float</span></dt><dd><p>Best-fit blackbody temperature in kilokelvins</p>
</dd>
<dt><strong>radius</strong><span class="classifier">float</span></dt><dd><p>Best-fit blackbody radius in units of 1000 solar radii</p>
</dd>
<dt><strong>dtemp</strong><span class="classifier">float</span></dt><dd><p>Uncertainty in the temperature in kilokelvins</p>
</dd>
<dt><strong>drad</strong><span class="classifier">float</span></dt><dd><p>Uncertainty in the radius in units of 1000 solar radii</p>
</dd>
<dt><strong>lum</strong><span class="classifier">float</span></dt><dd><p>Blackbody luminosity implied by the best-fit temperature and radius</p>
</dd>
<dt><strong>dlum</strong><span class="classifier">float</span></dt><dd><p>Uncertainty in the blackbody luminosity</p>
</dd>
<dt><strong>L_opt</strong><span class="classifier">float</span></dt><dd><p>Pseudobolometric luminosity from integrating the best-fit blackbody spectrum over the U-I filters</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.calc_colors">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">calc_colors</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#calc_colors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.calc_colors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate colors from a spectral energy distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>epoch1</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>A single “epoch” of photometry that defines the observed spectral energy distribution</p>
</dd>
<dt><strong>colors</strong><span class="classifier">list</span></dt><dd><p>A list of colors to calculate, e.g., <code class="docutils literal notranslate"><span class="pre">['U-B',</span> <span class="pre">'B-V',</span> <span class="pre">'g-r',</span> <span class="pre">'r-i']</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mags</strong><span class="classifier">list</span></dt><dd><p>A list of the calculated colors</p>
</dd>
<dt><strong>dmags</strong><span class="classifier">list</span></dt><dd><p>A list of uncertainties on the calculated colors, from propagating errors on the photometry points</p>
</dd>
<dt><strong>lolims</strong><span class="classifier">list</span></dt><dd><p>A list of booleans: True if the first filter is a nondetection or is absent from <code class="docutils literal notranslate"><span class="pre">epoch1</span></code></p>
</dd>
<dt><strong>uplims</strong><span class="classifier">list</span></dt><dd><p>A list of booleans: True if the second filter is a nondetection or is absent from <code class="docutils literal notranslate"><span class="pre">epoch1</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.calculate_bolometric">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">calculate_bolometric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_table_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_nfilt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">do_mcmc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_chains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">also_group_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#calculate_bolometric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.calculate_bolometric" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the full bolometric light curve from a table of broadband photometry</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lc</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>Table of broadband photometry including columns “MJD”, “mag”, “dmag”, “filter”</p>
</dd>
<dt><strong>z</strong><span class="classifier">float, optional</span></dt><dd><p>DEPRECATED: Include the redshift in <cite>lc.meta[‘redshift’]</cite> instead.</p>
</dd>
<dt><strong>outpath</strong><span class="classifier">str, optional</span></dt><dd><p>Directory to which to save the corner plots and MCMC chains. Default: current directory</p>
</dd>
<dt><strong>res</strong><span class="classifier">float, optional</span></dt><dd><p>Approximate resolution for grouping, in days. Default: 1 day.</p>
</dd>
<dt><strong>nwalkers</strong><span class="classifier">int, optional</span></dt><dd><p>Number of walkers (chains) to use for fitting. Default: 10</p>
</dd>
<dt><strong>burnin_steps</strong><span class="classifier">int, optional</span></dt><dd><p>Number of MCMC steps before convergence. This part of the history is discarded. Default: 200</p>
</dd>
<dt><strong>steps</strong><span class="classifier">int, optional</span></dt><dd><p>Number of MCMC steps after convergence. This part of the history is used to calculate paramers. Default: 100.</p>
</dd>
<dt><strong>priors</strong><span class="classifier">list, optional</span></dt><dd><p>Prior probability distributions for temperature (in kilokelvins) and radius (in 1000 solar radii). Available
priors: <a class="reference internal" href="#lightcurve_fitting.models.UniformPrior" title="lightcurve_fitting.models.UniformPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.UniformPrior</span></code></a>, <a class="reference internal" href="#lightcurve_fitting.models.LogUniformPrior" title="lightcurve_fitting.models.LogUniformPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.LogUniformPrior</span></code></a>, <a class="reference internal" href="#lightcurve_fitting.models.GaussianPrior" title="lightcurve_fitting.models.GaussianPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.GaussianPrior</span></code></a>.
Default: <code class="docutils literal notranslate"><span class="pre">T</span> <span class="pre">=</span> <span class="pre">Uniform(1.,</span> <span class="pre">100.)</span></code>, <code class="docutils literal notranslate"><span class="pre">R</span> <span class="pre">=</span> <span class="pre">LogUniform(0.01,</span> <span class="pre">1000.)</span></code>, <code class="docutils literal notranslate"><span class="pre">σ</span> <span class="pre">=</span> <span class="pre">Gaussian(0.,</span> <span class="pre">10.,</span> <span class="pre">stddev=1.)</span></code>.</p>
</dd>
<dt><strong>save_table_as</strong><span class="classifier">str, optional</span></dt><dd><p>Filename to which to save the output table of blackbody parameters and bolometric luminosities</p>
</dd>
<dt><strong>min_nfilt</strong><span class="classifier">int, optional</span></dt><dd><p>Minimum number of distinct observed filters required to calculate a luminosity. Default: 3</p>
</dd>
<dt><strong>cutoff_freq</strong><span class="classifier">float, optional</span></dt><dd><p>Cutoff frequency (in terahertz) for a modified blackbody spectrum (see <a class="reference external" href="https://doi.org/10.3847/1538-4357/aa9334">https://doi.org/10.3847/1538-4357/aa9334</a>)</p>
</dd>
<dt><strong>show</strong><span class="classifier">bool, optional</span></dt><dd><p>Plot the chain histories, and display all plots at the end of the script. Default: only save the corner plot</p>
</dd>
<dt><strong>colors</strong><span class="classifier">list, optional</span></dt><dd><p>A list of colors to calculate, e.g., <code class="docutils literal notranslate"><span class="pre">['U-B',</span> <span class="pre">'B-V',</span> <span class="pre">'g-r',</span> <span class="pre">'r-i']</span></code></p>
</dd>
<dt><strong>do_mcmc</strong><span class="classifier">bool, optional</span></dt><dd><p>If True (default), also fit the spectral energy distribution with an MCMC routine. This is slower but gives
more realistic uncertainties.</p>
</dd>
<dt><strong>save_chains</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, save the MCMC chain histories to the directory <code class="docutils literal notranslate"><span class="pre">outpath</span></code>. Default: only save the corner plot</p>
</dd>
<dt><strong>use_sigma</strong><span class="classifier">bool, optional</span></dt><dd><p>Include an intrinsic scatter parameter in the MCMC fit. Default: False.</p>
</dd>
<dt><strong>sigma_type</strong><span class="classifier">str, optional</span></dt><dd><p>If ‘relative’ (default), sigma will be in units of the individual photometric uncertainties.
If ‘absolute’, sigma will be in units of the median photometric uncertainty.</p>
</dd>
<dt><strong>also_group_by</strong><span class="classifier">list, optional</span></dt><dd><p>Group by these columns in addition to epoch</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>t0</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>Table containing the blackbody parameters, bolometric luminosities, and (optionally) colors</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.group_by_epoch">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">group_by_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">res</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">also_group_by</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">()</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#group_by_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.group_by_epoch" title="Permalink to this definition">¶</a></dt>
<dd><p>Group a light curve into epochs that will be treated as single spectral energy distributions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lc</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>Table containing the observed photometry. Must contain times in an “MJD” column.</p>
</dd>
<dt><strong>res</strong><span class="classifier">float, optional</span></dt><dd><p>Approximate resolution for grouping, in days. Default: 1 day.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>epochs.groups</strong><span class="classifier">astropy.table.TableGroups</span></dt><dd><p>Iterable containing single-epoch spectral energy distributions</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.integrate_sed">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">integrate_sed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#integrate_sed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.integrate_sed" title="Permalink to this definition">¶</a></dt>
<dd><p>Directly integrate a spectral energy distribution using the trapezoidal rule</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>epoch1</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>A single “epoch” of photometry that defines the observed spectral energy distribution</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>L_int</strong><span class="classifier">float</span></dt><dd><p>Luminosity in watts</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.median_and_unc">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">median_and_unc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perc_contained</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">68.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#median_and_unc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.median_and_unc" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the equal-tailed credible interval, centered on the median, for a sample of data</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array-like</span></dt><dd><p>The data sample</p>
</dd>
<dt><strong>perc_contained</strong><span class="classifier">float, optional</span></dt><dd><p>The percentage of the probability to be contained in the interval. Default: 68% (1σ)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>median</strong><span class="classifier">float</span></dt><dd><p>The median of <code class="docutils literal notranslate"><span class="pre">x</span></code></p>
</dd>
<dt><strong>lower</strong><span class="classifier">float</span></dt><dd><p>The lower boundary of the credible interval</p>
</dd>
<dt><strong>upper</strong><span class="classifier">float</span></dt><dd><p>The upper boundary of the credible interval</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.plot_bolometric_results">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">plot_bolometric_results</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_plot_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#plot_bolometric_results"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.plot_bolometric_results" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the parameters and bolometric light curves that result from fitting the spectral energy distribution</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t0</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>Table containing the results from fitting the spectral energy distribution</p>
</dd>
<dt><strong>save_plot_as</strong><span class="classifier">str, optional</span></dt><dd><p>Filename to which to save the plot.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fig</strong><span class="classifier">matplotlib.pyplot.Figure</span></dt><dd><p>Figure object containing the plot</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.plot_chain">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">plot_chain</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">chain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#plot_chain"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.plot_chain" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the chain histories for an MCMC run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>chain</strong><span class="classifier">array-like</span></dt><dd><p>Array containing the MCMC chain history, e.g., from <code class="xref py py-meth docutils literal notranslate"><span class="pre">emcee.EnsembleSampler.chain()</span></code></p>
</dd>
<dt><strong>labels</strong><span class="classifier">iterable, optional</span></dt><dd><p>A list of axis labels for each parameter in the chain</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fig</strong><span class="classifier">matplotlib.pyplot.Figure</span></dt><dd><p>Figure object containing the chain history plots</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.plot_color_curves">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">plot_color_curves</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fmt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'o'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">limit_length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'MJD'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#plot_color_curves"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.plot_color_curves" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the color curves calculated by <a class="reference internal" href="#lightcurve_fitting.bolometric.calculate_bolometric" title="lightcurve_fitting.bolometric.calculate_bolometric"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_bolometric()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>Output table from <a class="reference internal" href="#lightcurve_fitting.bolometric.calculate_bolometric" title="lightcurve_fitting.bolometric.calculate_bolometric"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_bolometric()</span></code></a></p>
</dd>
<dt><strong>colors</strong><span class="classifier">list, optional</span></dt><dd><p>List of colors to plot, e.g., <code class="docutils literal notranslate"><span class="pre">['g-r',</span> <span class="pre">'r-i']</span></code>. By default, plot all recognizable colors.</p>
</dd>
<dt><strong>fmt</strong><span class="classifier">str, optional</span></dt><dd><p>Format string, passed to <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.errorbar.html#matplotlib.pyplot.errorbar" title="(in Matplotlib v3.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.errorbar()</span></code></a></p>
</dd>
<dt><strong>limit_length</strong><span class="classifier">float, optional</span></dt><dd><p>Length (in data units) of the upper and lower limit markers</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fig</strong><span class="classifier">matplotlib.pyplot.Figure</span></dt><dd><p>Figure object containing the plot</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.pseudo">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">pseudo</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter0=&lt;filter</span> <span class="pre">I&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter1=&lt;filter</span> <span class="pre">U&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_freq=inf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#pseudo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.pseudo" title="Permalink to this definition">¶</a></dt>
<dd><p>Integrate a blackbody spectrum between two broadband filters to produce a pseudobolometric luminosity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>temp</strong><span class="classifier">float, array-like</span></dt><dd><p>Blackbody temperatures in kilokelvins</p>
</dd>
<dt><strong>radius</strong><span class="classifier">float, array-like</span></dt><dd><p>Blackbody radii in units of 1000 solar radii</p>
</dd>
<dt><strong>z</strong><span class="classifier">float</span></dt><dd><p>Redshift between the blackbody (rest frame) and the filters (observed frame)</p>
</dd>
<dt><strong>filter0, filter1</strong><span class="classifier">lightcurve_fitting.filters.Filter, optional</span></dt><dd><p>Filters to integrate between, where <code class="docutils literal notranslate"><span class="pre">filter1</span></code> is bluer than <code class="docutils literal notranslate"><span class="pre">filter0</span></code>. Default: U to I.</p>
</dd>
<dt><strong>cutoff_freq</strong><span class="classifier">float, optional</span></dt><dd><p>Cutoff frequency (in terahertz) for a modified blackbody spectrum (see <a class="reference external" href="https://doi.org/10.3847/1538-4357/aa9334">https://doi.org/10.3847/1538-4357/aa9334</a>)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>L_opt</strong><span class="classifier">float, array-like</span></dt><dd><p>Pseudobolometric luminosity in watts</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.spectrum_corner">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">spectrum_corner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler_flatchain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectrum_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_plot_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#spectrum_corner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.spectrum_corner" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the posterior distributions in a corner (pair) plot, with an inset showing the observed and model SEDs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spectrum</strong><span class="classifier">function</span></dt><dd><p>Function describing the spectrum. The first argument must be frequency in THz, and it must return spectral
luminosity in watts per hertz. For a blackbody, you can use <a class="reference internal" href="#lightcurve_fitting.models.planck_fast" title="lightcurve_fitting.models.planck_fast"><code class="xref py py-func docutils literal notranslate"><span class="pre">models.planck_fast()</span></code></a>.</p>
</dd>
<dt><strong>epoch1</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>A single “epoch” of photometry that defines the observed spectral energy distribution</p>
</dd>
<dt><strong>sampler_flatchain</strong><span class="classifier">array-like</span></dt><dd><p>2D array containing the aggregated MCMC chain histories</p>
</dd>
<dt><strong>z</strong><span class="classifier">float, optional</span></dt><dd><p>Redshift between the emission source and the observed filter. Default: 0.</p>
</dd>
<dt><strong>ebv</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Selective extinction <span class="math notranslate nohighlight">\(E(B-V)\)</span> in magnitudes, evaluated using a Fitzpatrick (1999) extinction law with
<span class="math notranslate nohighlight">\(R_V=3.1\)</span>. Its shape must be broadcastable to any array-like arguments. Default: 0.</p>
</dd>
<dt><strong>spectrum_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments to be passed to the <code class="docutils literal notranslate"><span class="pre">spectrum</span></code> function.</p>
</dd>
<dt><strong>use_sigma</strong><span class="classifier">bool, optional</span></dt><dd><p>Include an intrinsic scatter parameter. Default: False.</p>
</dd>
<dt><strong>labels</strong><span class="classifier">list, optional</span></dt><dd><p>Axis labels for the chain histories and corner plot.</p>
</dd>
<dt><strong>freq_min, freq_max</strong><span class="classifier">float, optional</span></dt><dd><p>Minimum and maximum frequencies for the SED panel in the corner plot. Default: (100., 1000.) or observed range.</p>
</dd>
<dt><strong>save_plot_as</strong><span class="classifier">str, optional</span></dt><dd><p>Filename to which to save the resulting plot</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>f4</strong><span class="classifier">matplotlib.pyplot.Figure</span></dt><dd><p>Figure containing the corner and SED plots.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.spectrum_mcmc">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">spectrum_mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectrum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epoch1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">starting_guesses</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spectrum_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outpath</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">burnin_steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">steps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_chains</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">freq_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#spectrum_mcmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.spectrum_mcmc" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit the given spectral energy distribution to an epoch of photometry using a Markov-chain Monte Carlo routine</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spectrum</strong><span class="classifier">function</span></dt><dd><p>Function describing the spectrum. The first argument must be frequency in THz, and it must return spectral
luminosity in watts per hertz. For a blackbody, you can use <a class="reference internal" href="#lightcurve_fitting.models.planck_fast" title="lightcurve_fitting.models.planck_fast"><code class="xref py py-func docutils literal notranslate"><span class="pre">models.planck_fast()</span></code></a>.</p>
</dd>
<dt><strong>epoch1</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>A single “epoch” of photometry that defines the observed spectral energy distribution</p>
</dd>
<dt><strong>priors</strong><span class="classifier">list</span></dt><dd><p>Prior probability distributions for each model parameter (and sigma, if used). Available priors:
<a class="reference internal" href="#lightcurve_fitting.models.UniformPrior" title="lightcurve_fitting.models.UniformPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.UniformPrior</span></code></a> (default), <a class="reference internal" href="#lightcurve_fitting.models.LogUniformPrior" title="lightcurve_fitting.models.LogUniformPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.LogUniformPrior</span></code></a>, <a class="reference internal" href="#lightcurve_fitting.models.GaussianPrior" title="lightcurve_fitting.models.GaussianPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.GaussianPrior</span></code></a></p>
</dd>
<dt><strong>starting_guesses</strong><span class="classifier">array-like</span></dt><dd><p>Initial guesses for each input parameter to <code class="docutils literal notranslate"><span class="pre">spectrum</span></code>. Must have shape (nwalkers, nparameters).</p>
</dd>
<dt><strong>z</strong><span class="classifier">float, optional</span></dt><dd><p>Redshift between the emission source and the observed filter. Default: 0.</p>
</dd>
<dt><strong>ebv</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Selective extinction <span class="math notranslate nohighlight">\(E(B-V)\)</span> in magnitudes, evaluated using a Fitzpatrick (1999) extinction law with
<span class="math notranslate nohighlight">\(R_V=3.1\)</span>. Its shape must be broadcastable to any array-like arguments. Default: 0.</p>
</dd>
<dt><strong>spectrum_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments to be passed to the <code class="docutils literal notranslate"><span class="pre">spectrum</span></code> function.</p>
</dd>
<dt><strong>show</strong><span class="classifier">bool, optional</span></dt><dd><p>Plot the chain histories, and display all plots at the end of the script. Default: only save the corner plot</p>
</dd>
<dt><strong>outpath</strong><span class="classifier">str, optional</span></dt><dd><p>Directory to which to save the corner plots. Default: current directory</p>
</dd>
<dt><strong>nwalkers</strong><span class="classifier">int, optional</span></dt><dd><p>Number of walkers (chains) to use for fitting. Default: 10</p>
</dd>
<dt><strong>burnin_steps</strong><span class="classifier">int, optional</span></dt><dd><p>Number of MCMC steps before convergence. This part of the history is discarded. Default: 200</p>
</dd>
<dt><strong>steps</strong><span class="classifier">int, optional</span></dt><dd><p>Number of MCMC steps after convergence. This part of the history is used to calculate parameters. Default: 100.</p>
</dd>
<dt><strong>save_chains</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, save the MCMC chain histories to the directory <code class="docutils literal notranslate"><span class="pre">outpath</span></code>. Default: only save the corner plot</p>
</dd>
<dt><strong>use_sigma</strong><span class="classifier">bool, optional</span></dt><dd><p>Include an intrinsic scatter parameter. Default: False.</p>
</dd>
<dt><strong>sigma_type</strong><span class="classifier">str, optional</span></dt><dd><p>If ‘relative’ (default), sigma will be in units of the individual photometric uncertainties.
If ‘absolute’, sigma will be in units of the median photometric uncertainty.</p>
</dd>
<dt><strong>labels</strong><span class="classifier">list, optional</span></dt><dd><p>Axis labels for the chain histories and corner plot.</p>
</dd>
<dt><strong>freq_min, freq_max</strong><span class="classifier">float, optional</span></dt><dd><p>Minimum and maximum frequencies for the SED panel in the corner plot. Default: (100., 1000.) or observed range.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>sampler</strong><span class="classifier">emcee.EnsembleSampler</span></dt><dd><p>Sampler object containing the results of the MCMC fit</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.bolometric.stefan_boltzmann">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.bolometric.</span></span><span class="sig-name descname"><span class="pre">stefan_boltzmann</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">temp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radius</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtemp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drad</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covTR</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/bolometric.html#stefan_boltzmann"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.bolometric.stefan_boltzmann" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate blackbody luminosity and associated uncertainty using the Stefan-Boltzmann law</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>temp</strong><span class="classifier">float, array-like</span></dt><dd><p>Temperature in kilokelvins</p>
</dd>
<dt><strong>radius</strong><span class="classifier">float, array-like</span></dt><dd><p>Radius in units of 1000 solar radii</p>
</dd>
<dt><strong>dtemp</strong><span class="classifier">float, array-like</span></dt><dd><p>Uncertainty in the temperature in kilokelvins</p>
</dd>
<dt><strong>drad</strong><span class="classifier">float, array-like</span></dt><dd><p>Uncertainty in the radius in units of 1000 solar radii</p>
</dd>
<dt><strong>covTR</strong><span class="classifier">float, array-like</span></dt><dd><p>Covariance between the temperature and radius</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>lum</strong><span class="classifier">float, array-like</span></dt><dd><p>Luminosity in watts</p>
</dd>
<dt><strong>dlum</strong><span class="classifier">float, array-like</span></dt><dd><p>Uncertainty in the luminosity in watts</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-lightcurve_fitting.filters">
<span id="lightcurve-fitting-filters-module"></span><h2>lightcurve_fitting.filters module<a class="headerlink" href="#module-lightcurve_fitting.filters" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.filters.</span></span><span class="sig-name descname"><span class="pre">Filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">system</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fnu</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.631e-23</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">angstrom</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linecolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">textcolor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mec</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">italics</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/filters.html#Filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.filters.Filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>A broadband photometric filter described by its transmission function and its associated photometric system</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>names</strong><span class="classifier">str, list</span></dt><dd><p>One or more names for the filter. The first name is used by default but other names are recognized.</p>
</dd>
<dt><strong>color</strong><span class="classifier">str, tuple, optional</span></dt><dd><p>The color used when plotting photometry in this filter. Default: black.</p>
</dd>
<dt><strong>offset</strong><span class="classifier">float, optional</span></dt><dd><p>When plotting, offset photometry in this filter by this amount (in magnitudes if plotting magnitudes)</p>
</dd>
<dt><strong>system</strong><span class="classifier">str, optional</span></dt><dd><p>Photometric system. Only used for grouping filters in legends.</p>
</dd>
<dt><strong>fnu</strong><span class="classifier">float, optional</span></dt><dd><p>Zero-point flux for magnitudes in this filter, in W/(m^2 Hz). If <code class="docutils literal notranslate"><span class="pre">fnu</span> <span class="pre">=</span> <span class="pre">None</span></code> and <code class="docutils literal notranslate"><span class="pre">system</span> <span class="pre">in</span> <span class="pre">['Gunn',</span>
<span class="pre">'ATLAS',</span> <span class="pre">'Gaia',</span> <span class="pre">'MOSFiT']</span></code>, assume the AB zero point. Otherwise if <code class="docutils literal notranslate"><span class="pre">fnu</span> <span class="pre">=</span> <span class="pre">None</span></code>, converting to flux will raise
an error.</p>
</dd>
<dt><strong>filename</strong><span class="classifier">str, optional</span></dt><dd><p>Filename containing the transmission function. If none is supplied, converting to flux will raise an error.</p>
</dd>
<dt><strong>angstrom</strong><span class="classifier">bool, optional</span></dt><dd><p>If False (default), the transmission function wavelengths are assumed to be in nanometers. If True, they are
given in ångströms.</p>
</dd>
<dt><strong>linecolor</strong><span class="classifier">str, tuple, optional</span></dt><dd><p>The line color used when plotting photometry in this filter. Default: same as <code class="docutils literal notranslate"><span class="pre">color</span></code>.</p>
</dd>
<dt><strong>textcolor</strong><span class="classifier">str, tuple, optional</span></dt><dd><p>The color used when printing the name of this filter. Default: same as <code class="docutils literal notranslate"><span class="pre">linecolor</span></code>.</p>
</dd>
<dt><strong>mec</strong><span class="classifier">str, tuple, optional</span></dt><dd><p>The marker edge color used when plotting photometry in this filter. Default: same as <code class="docutils literal notranslate"><span class="pre">linecolor</span></code>.</p>
</dd>
<dt><strong>italics</strong><span class="classifier">bool, optional</span></dt><dd><p>Italicize the filter name when used with LaTeX. Default: True.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>name</strong><span class="classifier">str</span></dt><dd><p>The default name of the filter</p>
</dd>
<dt><strong>names</strong><span class="classifier">list</span></dt><dd><p>A list of aliases for the filter</p>
</dd>
<dt><strong>char</strong><span class="classifier">str</span></dt><dd><p>A single-character identifier for the filter</p>
</dd>
<dt><strong>color</strong><span class="classifier">str, tuple</span></dt><dd><p>The color used when plotting photometry in this filter</p>
</dd>
<dt><strong>linecolor</strong><span class="classifier">str, tuple</span></dt><dd><p>The line and marker edge color used when plotting photometry in this filter</p>
</dd>
<dt><strong>textcolor</strong><span class="classifier">str, tuple</span></dt><dd><p>The color used when printing the name of this filter</p>
</dd>
<dt><strong>italics</strong><span class="classifier">bool</span></dt><dd><p>Italicize the filter name when used with LaTeX</p>
</dd>
<dt><strong>mec</strong><span class="classifier">str, tuple</span></dt><dd><p>The marker edge color used when plotting photometry in this filter</p>
</dd>
<dt><strong>plotstyle</strong><span class="classifier">dict</span></dt><dd><p>Contains all keyword arguments for plotting photometry in this filter</p>
</dd>
<dt><strong>offset</strong><span class="classifier">float</span></dt><dd><p>When plotting, offset photometry in this filter by this amount (in magnitudes if plotting magnitudes)</p>
</dd>
<dt><strong>system</strong><span class="classifier">str</span></dt><dd><p>The photometric system for magnitudes in this filter</p>
</dd>
<dt><strong>fnu</strong><span class="classifier">float</span></dt><dd><p>The zero-point flux for magnitudes in this filter, in watts per square meter per hertz</p>
</dd>
<dt><strong>m0</strong><span class="classifier">float</span></dt><dd><p>The zero point for magnitudes in this filter, i.e., <span class="math notranslate nohighlight">\(m_0 = 2.5 \log_{10}(F_ν)\)</span></p>
</dd>
<dt><strong>M0</strong><span class="classifier">float</span></dt><dd><p>The zero point for absolute magnitudes in this filter, i.e., <span class="math notranslate nohighlight">\(M_0 = m_0 + 90.19\)</span></p>
</dd>
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Filename containing the transmission function</p>
</dd>
<dt><strong>angstrom</strong><span class="classifier">bool</span></dt><dd><p>If False (default), the transmission function wavelengths are assumed to be in nanometers. If True, they are
given in ångströms.</p>
</dd>
<dt><strong>trans</strong><span class="classifier">astropy.table.Table</span></dt><dd><p>The transmission function</p>
</dd>
<dt><strong>freq_eff</strong><span class="classifier">float</span></dt><dd><p>The effective frequency of the filter (in terahertz), i.e., <span class="math notranslate nohighlight">\(ν_0 = \frac{1}{Δν} \int ν T(ν) dν\)</span></p>
</dd>
<dt><strong>dfreq</strong><span class="classifier">float</span></dt><dd><p>The effective bandwidth of the filter (in terahertz), i.e., <span class="math notranslate nohighlight">\(Δν = \int T(ν) dν\)</span></p>
</dd>
<dt><strong>freq_range</strong><span class="classifier">tuple</span></dt><dd><p>The approximate edges of the filter transmission function (in terahertz), i.e., <span class="math notranslate nohighlight">\(ν_0 \pm Δν\)</span></p>
</dd>
</dl>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.dfreq">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dfreq</span></span><a class="headerlink" href="#lightcurve_fitting.filters.Filter.dfreq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.dwl">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">dwl</span></span><a class="headerlink" href="#lightcurve_fitting.filters.Filter.dwl" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.extinction">
<span class="sig-name descname"><span class="pre">extinction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ebv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/filters.html#Filter.extinction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.filters.Filter.extinction" title="Permalink to this definition">¶</a></dt>
<dd><p>Extinction <span class="math notranslate nohighlight">\(A_\lambda\)</span> at the effective wavelength of this filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ebv</strong><span class="classifier">array-like</span></dt><dd><p>Selective extinction <span class="math notranslate nohighlight">\(E(B-V)\)</span> in magnitudes</p>
</dd>
<dt><strong>rv</strong><span class="classifier">float, optional</span></dt><dd><p>Ratio of total to selective extinction <span class="math notranslate nohighlight">\(R_V\)</span>. Default: 3.1.</p>
</dd>
<dt><strong>z</strong><span class="classifier">float, optional</span></dt><dd><p>Redshift between the dust and the observed filter. Default: 0 (appropriate for Milky Way extinction).</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>extinction</strong><span class="classifier">float</span></dt><dd><p>Extinction at the effective wavelength of this filter in magnitudes</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.freq_eff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">freq_eff</span></span><a class="headerlink" href="#lightcurve_fitting.filters.Filter.freq_eff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.freq_range">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">freq_range</span></span><a class="headerlink" href="#lightcurve_fitting.filters.Filter.freq_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.order">
<span class="sig-name descname"><span class="pre">order</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['FUV',</span> <span class="pre">'NUV',</span> <span class="pre">'UVW2',</span> <span class="pre">'UVM2',</span> <span class="pre">'UVW1',</span> <span class="pre">'u',</span> <span class="pre">'U_S',</span> <span class="pre">'U',</span> <span class="pre">'B',</span> <span class="pre">'B_S',</span> <span class="pre">'g',</span> <span class="pre">'g-DECam',</span> <span class="pre">'c',</span> <span class="pre">'V',</span> <span class="pre">'V_S',</span> <span class="pre">'Itagaki',</span> <span class="pre">'white',</span> <span class="pre">'unfilt.',</span> <span class="pre">'G',</span> <span class="pre">'Kepler',</span> <span class="pre">'TESS',</span> <span class="pre">'DLT40',</span> <span class="pre">'w',</span> <span class="pre">'o',</span> <span class="pre">'r',</span> <span class="pre">'r-DECam',</span> <span class="pre">'R',</span> <span class="pre">'i',</span> <span class="pre">'i-DECam',</span> <span class="pre">'I',</span> <span class="pre">'zs',</span> <span class="pre">'z',</span> <span class="pre">'z-DECam',</span> <span class="pre">'y',</span> <span class="pre">'y-DECam',</span> <span class="pre">'J',</span> <span class="pre">'H',</span> <span class="pre">'K',</span> <span class="pre">'L',</span> <span class="pre">'F070W',</span> <span class="pre">'F090W',</span> <span class="pre">'F115W',</span> <span class="pre">'F150W',</span> <span class="pre">'F200W',</span> <span class="pre">'F277W',</span> <span class="pre">'F300M',</span> <span class="pre">'F335M',</span> <span class="pre">'F356W',</span> <span class="pre">'F360M',</span> <span class="pre">'F444W',</span> <span class="pre">'F560W',</span> <span class="pre">'F770W',</span> <span class="pre">'F1000W',</span> <span class="pre">'F1130W',</span> <span class="pre">'F1280W',</span> <span class="pre">'F1500W',</span> <span class="pre">'F1800W',</span> <span class="pre">'F2100W',</span> <span class="pre">'F2550W',</span> <span class="pre">'unknown']</span></em><a class="headerlink" href="#lightcurve_fitting.filters.Filter.order" title="Permalink to this definition">¶</a></dt>
<dd><p>The names of recognized filters listed in (approximate) decreasing order of effective frequency</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.read_curve">
<span class="sig-name descname"><span class="pre">read_curve</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">force</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/filters.html#Filter.read_curve"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.filters.Filter.read_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the transmission function from <code class="docutils literal notranslate"><span class="pre">self.filename</span></code> and store it in <code class="docutils literal notranslate"><span class="pre">self.trans</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>show</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, also plot the transmission function</p>
</dd>
<dt><strong>force</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, reread the transmission function from <code class="docutils literal notranslate"><span class="pre">self.filename</span></code> even if is already stored in <code class="docutils literal notranslate"><span class="pre">self.trans</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.spectrum">
<span class="sig-name descname"><span class="pre">spectrum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lum</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/filters.html#Filter.spectrum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.filters.Filter.spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the average value of the given spectrum in this filter</p>
<p>The limits of integration come from the input spectrum, so if the spectrum does not cover the full filter, this
function returns the average Lnu within the overlapping region, i.e., it does not extrapolate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>freq</strong><span class="classifier">float or array-like</span></dt><dd><p>Frequency of the input spectrum in THz</p>
</dd>
<dt><strong>lum</strong><span class="classifier">float or array-like</span></dt><dd><p>Spectral luminosity (Lnu) or flux (Fnu) of the input spectrum</p>
</dd>
<dt><strong>z</strong><span class="classifier">float, optional</span></dt><dd><p>Redshift between the spectrum and the filter. Default: 0.</p>
</dd>
<dt><strong>ebv</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Selective extinction <span class="math notranslate nohighlight">\(E(B-V)\)</span> in magnitudes, evaluated using a Fitzpatrick (1999) extinction law with
<span class="math notranslate nohighlight">\(R_V=3.1\)</span>. Default: 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Lnu</strong><span class="classifier">float or array-like</span></dt><dd><p>Average spectral luminosity (Lnu) or flux (Fnu) in the filter</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.synthesize">
<span class="sig-name descname"><span class="pre">synthesize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectrum</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/filters.html#Filter.synthesize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.filters.Filter.synthesize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the average Lnu of the given spectrum in this filter</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spectrum</strong><span class="classifier">function</span></dt><dd><p>Function describing the spectrum. The first argument must be frequency in THz, and it must return spectral
luminosity in watts per hertz. All arguments are passed to this function except for keywords z and ebv.</p>
</dd>
<dt><strong>z</strong><span class="classifier">float, optional</span></dt><dd><p>Redshift between the emission source and the observed filter. Default: 0.</p>
</dd>
<dt><strong>ebv</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Selective extinction <span class="math notranslate nohighlight">\(E(B-V)\)</span> in magnitudes, evaluated using a Fitzpatrick (1999) extinction law with
<span class="math notranslate nohighlight">\(R_V=3.1\)</span>. Its shape must be broadcastable to any array-like arguments. Default: 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Lnu</strong><span class="classifier">float or array-like</span></dt><dd><p>Average spectral luminosity in the filter in watts per hertz</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.trans">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">trans</span></span><a class="headerlink" href="#lightcurve_fitting.filters.Filter.trans" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.wl_eff">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wl_eff</span></span><a class="headerlink" href="#lightcurve_fitting.filters.Filter.wl_eff" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.Filter.wl_range">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">wl_range</span></span><a class="headerlink" href="#lightcurve_fitting.filters.Filter.wl_range" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.filters.extinction_law">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.filters.</span></span><span class="sig-name descname"><span class="pre">extinction_law</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">freq</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebv</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/filters.html#extinction_law"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.filters.extinction_law" title="Permalink to this definition">¶</a></dt>
<dd><p>A vectorized version of the Fitzpatrick (1999) extinction law from the <code class="docutils literal notranslate"><span class="pre">extinction</span></code> package</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>freq</strong><span class="classifier">array-like</span></dt><dd><p>Frequencies in THz in the frame of the dust</p>
</dd>
<dt><strong>ebv</strong><span class="classifier">array-like</span></dt><dd><p>Selective extinction <span class="math notranslate nohighlight">\(E(B-V)\)</span> in magnitudes</p>
</dd>
<dt><strong>rv</strong><span class="classifier">float, optional</span></dt><dd><p>Ratio of total to selective extinction <span class="math notranslate nohighlight">\(R_V\)</span>. Default: 3.1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>extinction</strong><span class="classifier">array-like</span></dt><dd><p>Extinction factor <span class="math notranslate nohighlight">\(10^{A/-2.5}\)</span> at each input wavelength.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-lightcurve_fitting.fitting">
<span id="lightcurve-fitting-fitting-module"></span><h2>lightcurve_fitting.fitting module<a class="headerlink" href="#module-lightcurve_fitting.fitting" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.fitting.format_credible_interval">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.fitting.</span></span><span class="sig-name descname"><span class="pre">format_credible_interval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigfigs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentiles</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(15.87,</span> <span class="pre">50.0,</span> <span class="pre">84.14)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/fitting.html#format_credible_interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.fitting.format_credible_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Use LaTeX to format an equal-tailed credible interval with a given number of significant figures in the uncertainty</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array-like</span></dt><dd><p>Data from which to calculate the credible interval</p>
</dd>
<dt><strong>sigfigs</strong><span class="classifier">int, optional</span></dt><dd><p>Number of significant figures in the uncertainty. Default: 1</p>
</dd>
<dt><strong>percentiles</strong><span class="classifier">tuple, optional</span></dt><dd><p>Percentiles for the (lower, center, upper) of the credible interval. Default: <code class="docutils literal notranslate"><span class="pre">(15.87,</span> <span class="pre">50.,</span> <span class="pre">84.14)</span></code>
(median +/- 1σ)</p>
</dd>
<dt><strong>axis</strong><span class="classifier">int, optional</span></dt><dd><p>Axis of <code class="docutils literal notranslate"><span class="pre">x</span></code> along which to calculate the credible intervals. Default: 0</p>
</dd>
<dt><strong>varnames</strong><span class="classifier">list, optional</span></dt><dd><p>Variable names to be equated with the credible intervals. Default: no variable names</p>
</dd>
<dt><strong>units</strong><span class="classifier">list, optional</span></dt><dd><p>Units to be applied to the credible intervals. Default: no units</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>paramtexts</strong><span class="classifier">str</span></dt><dd><p>The formatted credible intervals</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.fitting.lightcurve_corner">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.fitting.</span></span><span class="sig-name descname"><span class="pre">lightcurve_corner</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler_flatchain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_models_to_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lcaxis_posn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(0.7,</span> <span class="pre">0.55,</span> <span class="pre">0.2,</span> <span class="pre">0.4)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t0_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_plot_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ycol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">textsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'medium'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">param_textsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'large'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/fitting.html#lightcurve_corner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.fitting.lightcurve_corner" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the posterior distributions in a corner (pair) plot, with an inset showing the observed and model light curves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lc</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>Table of broadband photometry including columns “MJD”, “mag”, “dmag”, “filter”</p>
</dd>
<dt><strong>model</strong><span class="classifier">lightcurve_fitting.models.Model</span></dt><dd><p>The model that was fit to the light curve.</p>
</dd>
<dt><strong>sampler_flatchain</strong><span class="classifier">array-like</span></dt><dd><p>2D array containing the aggregated MCMC chain histories</p>
</dd>
<dt><strong>model_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>DEPRECATED: Keyword arguments are now included in the model initialization</p>
</dd>
<dt><strong>num_models_to_plot</strong><span class="classifier">int, optional</span></dt><dd><p>Number of model realizations to plot in the light curve inset. Default: 100</p>
</dd>
<dt><strong>lcaxis_posn</strong><span class="classifier">tuple, optional</span></dt><dd><p>Light curve inset position and size specification in figure units: (left, bottom, width, height)</p>
</dd>
<dt><strong>filter_spacing</strong><span class="classifier">float, optional</span></dt><dd><p>Spacing between filters in the light curve inset, in units determined by the order of magnitude of the
luminosities. Default: 1.</p>
</dd>
<dt><strong>tmin, tmax</strong><span class="classifier">float, optional</span></dt><dd><p>Starting and ending times for which to plot the models in the light curve inset. Default: determined by the
time range of the observed light curve.</p>
</dd>
<dt><strong>t0_offset</strong><span class="classifier">float, optional</span></dt><dd><p>Reference time for the explosion time in the corner plot. Default: the earliest explosion time in
<cite>sampler_flatchain</cite>, rounded down.</p>
</dd>
<dt><strong>save_plot_as</strong><span class="classifier">str, optional</span></dt><dd><p>Filename to which to save the resulting plot</p>
</dd>
<dt><strong>ycol</strong><span class="classifier">str, optional</span></dt><dd><p>Quantity to plot on the light curve inset. Choices: “lum”, “flux”, or “absmag”. Default: model.output_quantity</p>
</dd>
<dt><strong>textsize</strong><span class="classifier">str, optional</span></dt><dd><p>Font size for the x- and y-axis labels, as well as the tick labels. Default: ‘medium’</p>
</dd>
<dt><strong>param_textsize</strong><span class="classifier">str, optional</span></dt><dd><p>Font size for the parameter text. Default: ‘large’</p>
</dd>
<dt><strong>use_sigma</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, treat the last parameter as an intrinsic scatter parameter that does not get passed to the model</p>
</dd>
<dt><strong>xscale</strong><span class="classifier">str, optional</span></dt><dd><p>Scale for the x-axis of the model plot. Choices: “linear” (default) or “log”.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fig</strong><span class="classifier">matplotlib.pyplot.Figure</span></dt><dd><p>Figure object containing the plot</p>
</dd>
<dt><strong>corner_ax</strong><span class="classifier">array-like</span></dt><dd><p>Array of matplotlib.pyplot.Axes objects corresponding to the corner plot</p>
</dd>
<dt><strong>ax</strong><span class="classifier">matplotlib.pyplot.Axes</span></dt><dd><p>Axes object for the light curve inset</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.fitting.lightcurve_mcmc">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.fitting.</span></span><span class="sig-name descname"><span class="pre">lightcurve_mcmc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priors</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_lo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_up</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nwalkers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nsteps_burnin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_plot_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_sampler_as</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/fitting.html#lightcurve_mcmc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.fitting.lightcurve_mcmc" title="Permalink to this definition">¶</a></dt>
<dd><p>Fit an analytical model to observed photometry using a Markov-chain Monte Carlo routine</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lc</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>Table of broadband photometry including columns “MJD”, “mag”, “dmag”, “filter”</p>
</dd>
<dt><strong>model</strong><span class="classifier">lightcurve_fitting.models.Model</span></dt><dd><p>The model to fit to the light curve. Available models: <a class="reference internal" href="#lightcurve_fitting.models.ShockCooling" title="lightcurve_fitting.models.ShockCooling"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.ShockCooling</span></code></a>,
<a class="reference internal" href="#lightcurve_fitting.models.ShockCooling2" title="lightcurve_fitting.models.ShockCooling2"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.ShockCooling2</span></code></a>, <a class="reference internal" href="#lightcurve_fitting.models.ShockCooling3" title="lightcurve_fitting.models.ShockCooling3"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.ShockCooling3</span></code></a>, <a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking" title="lightcurve_fitting.models.CompanionShocking"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.CompanionShocking</span></code></a>,
<a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking2" title="lightcurve_fitting.models.CompanionShocking2"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.CompanionShocking2</span></code></a>, <a class="reference internal" href="#lightcurve_fitting.models.CompanionShocking3" title="lightcurve_fitting.models.CompanionShocking3"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.CompanionShocking3</span></code></a></p>
</dd>
<dt><strong>priors</strong><span class="classifier">list, optional</span></dt><dd><p>Prior probability distributions for each model parameter. Available priors:
<a class="reference internal" href="#lightcurve_fitting.models.UniformPrior" title="lightcurve_fitting.models.UniformPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.UniformPrior</span></code></a> (default), <a class="reference internal" href="#lightcurve_fitting.models.LogUniformPrior" title="lightcurve_fitting.models.LogUniformPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.LogUniformPrior</span></code></a>, <a class="reference internal" href="#lightcurve_fitting.models.GaussianPrior" title="lightcurve_fitting.models.GaussianPrior"><code class="xref py py-class docutils literal notranslate"><span class="pre">models.GaussianPrior</span></code></a></p>
</dd>
<dt><strong>p_min, p_max</strong><span class="classifier">list, optional</span></dt><dd><p>DEPRECATED: Use <cite>priors</cite> instead</p>
</dd>
<dt><strong>p_lo</strong><span class="classifier">list</span></dt><dd><p>Lower bounds on the starting guesses for each paramter</p>
</dd>
<dt><strong>p_up</strong><span class="classifier">list</span></dt><dd><p>Upper bounds on the starting guesses for each parameter</p>
</dd>
<dt><strong>nwalkers</strong><span class="classifier">int, optional</span></dt><dd><p>Number of walkers (chains) for the MCMC routine. Default: 100</p>
</dd>
<dt><strong>nsteps</strong><span class="classifier">int, optional</span></dt><dd><p>Number of steps (iterations) for the MCMC routine, excluding burn-in. Default: 1000</p>
</dd>
<dt><strong>nsteps_burnin</strong><span class="classifier">int, optional</span></dt><dd><p>Number of steps (iterations) for the MCMC routine during burn-in. Default: 1000</p>
</dd>
<dt><strong>model_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>DEPRECATED: Keyword arguments are now included in the model initialization</p>
</dd>
<dt><strong>show</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, plot and display the chain histories</p>
</dd>
<dt><strong>save_plot_as</strong><span class="classifier">str, optional</span></dt><dd><p>Save a plot of the chain histories to this filename</p>
</dd>
<dt><strong>save_sampler_as</strong><span class="classifier">str, optional</span></dt><dd><p>Save the aggregated chain histories to this filename</p>
</dd>
<dt><strong>use_sigma</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, treat the last parameter as an intrinsic scatter parameter that does not get passed to the model</p>
</dd>
<dt><strong>sigma_type</strong><span class="classifier">str, optional</span></dt><dd><p>If ‘relative’ (default), sigma will be in units of the individual photometric uncertainties.
If ‘absolute’, sigma will be in units of the median photometric uncertainty.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>sampler</strong><span class="classifier">emcee.EnsembleSampler</span></dt><dd><p>EnsembleSampler object containing the results of the fit</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.fitting.lightcurve_model_plot">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.fitting.</span></span><span class="sig-name descname"><span class="pre">lightcurve_model_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampler_flatchain</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_models_to_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filter_spacing</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ycol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">textsize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'medium'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mjd_offset</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xscale</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'linear'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/fitting.html#lightcurve_model_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.fitting.lightcurve_model_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the observed and model light curves.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lc</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>Table of broadband photometry including columns “MJD”, “mag”, “dmag”, “filter”</p>
</dd>
<dt><strong>model</strong><span class="classifier">lightcurve_fitting.models.Model</span></dt><dd><p>The model that was fit to the light curve.</p>
</dd>
<dt><strong>sampler_flatchain</strong><span class="classifier">array-like</span></dt><dd><p>2D array containing the aggregated MCMC chain histories</p>
</dd>
<dt><strong>model_kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>DEPRECATED: Keyword arguments are now included in the model initialization.</p>
</dd>
<dt><strong>num_models_to_plot</strong><span class="classifier">int, optional</span></dt><dd><p>Number of model realizations to plot in the light curve inset. Default: 100</p>
</dd>
<dt><strong>filter_spacing</strong><span class="classifier">float, optional</span></dt><dd><p>Spacing between filters in the light curve inset, in units determined by the order of magnitude of the
luminosities. Default: 1.</p>
</dd>
<dt><strong>tmin, tmax</strong><span class="classifier">float, optional</span></dt><dd><p>Starting and ending times for which to plot the models in the light curve inset. Default: determined by the
time range of the observed light curve.</p>
</dd>
<dt><strong>ycol</strong><span class="classifier">str, optional</span></dt><dd><p>Quantity to plot on the light curve inset. Choices: “lum”, “flux”, or “absmag”. Default: model.output_quantity</p>
</dd>
<dt><strong>textsize</strong><span class="classifier">str, optional</span></dt><dd><p>Font size for the x- and y-axis labels, as well as the tick labels. Default: ‘medium’</p>
</dd>
<dt><strong>ax</strong><span class="classifier">matplotlib.pyplot.Axes</span></dt><dd><p>Axis on which to plot the light curves</p>
</dd>
<dt><strong>mjd_offset</strong><span class="classifier">float, optional</span></dt><dd><p>Reference time on the horizontal axis of the light curve inset. Default: determined by the starting time of
the model light curve.</p>
</dd>
<dt><strong>use_sigma</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, treat the last parameter as an intrinsic scatter parameter that does not get passed to the model</p>
</dd>
<dt><strong>xscale</strong><span class="classifier">str, optional</span></dt><dd><p>Scale for the x-axis. Choices: “linear” (default) or “log”.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-lightcurve_fitting.lightcurve">
<span id="lightcurve-fitting-lightcurve-module"></span><h2>lightcurve_fitting.lightcurve module<a class="headerlink" href="#module-lightcurve_fitting.lightcurve" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.Arrow">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.lightcurve.</span></span><span class="sig-name descname"><span class="pre">Arrow</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hx</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hy</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#Arrow"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.Arrow" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://matplotlib.org/stable/api/path_api.html#matplotlib.path.Path" title="(in Matplotlib v3.7.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Path</span></code></a></p>
<p>An downward-pointing arrow-shaped <code class="docutils literal notranslate"><span class="pre">Path</span></code>, whose head has half-width <code class="docutils literal notranslate"><span class="pre">hx</span></code> and height <code class="docutils literal notranslate"><span class="pre">hy</span></code> (in units of length)</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.lightcurve.</span></span><span class="sig-name descname"><span class="pre">LC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a></p>
<p>A broadband light curve, stored as an <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.table.Table</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nondetSigmas</strong><span class="classifier">float</span></dt><dd><p>Significance level implied by nondetections in the light curve. Default: 3σ</p>
</dd>
<dt><strong>groupby</strong><span class="classifier">set</span></dt><dd><p>Column names to group by when binning the light curve. Default: <code class="docutils literal notranslate"><span class="pre">{'filter',</span> <span class="pre">'source'}</span></code></p>
</dd>
<dt><strong>markers</strong><span class="classifier">dict</span></dt><dd><p>Mapping of some light curve property (default: <code class="docutils literal notranslate"><span class="pre">'source'</span></code> or <code class="docutils literal notranslate"><span class="pre">'telescope'</span></code>) to marker shapes</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.bin">
<span class="sig-name descname"><span class="pre">bin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.bin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.bin" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin the light curve by averaging points within <code class="docutils literal notranslate"><span class="pre">delta</span></code> days of each other</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>delta</strong><span class="classifier">float, optional</span></dt><dd><p>Bin size, in days. Default: 0.3 days</p>
</dd>
<dt><strong>groupby</strong><span class="classifier">set, optional</span></dt><dd><p>Column names to group by before binning. Default: <code class="docutils literal notranslate"><span class="pre">{'filter',</span> <span class="pre">'source'}</span></code></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>lc</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>Binned light curve</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.calcAbsMag">
<span class="sig-name descname"><span class="pre">calcAbsMag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">extinction</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hostext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">host_ebv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">host_rv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.calcAbsMag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.calcAbsMag" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <code class="docutils literal notranslate"><span class="pre">'absmag'</span></code> column from the <code class="docutils literal notranslate"><span class="pre">'mag'</span></code> column by correcting for distance and extinction</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>dm</strong><span class="classifier">float, optional</span></dt><dd><p>Distance modulus. Default: calculate from <code class="docutils literal notranslate"><span class="pre">redshift</span></code>.</p>
</dd>
<dt><strong>extinction</strong><span class="classifier">dict, optional</span></dt><dd><p>Milky Way extinction coefficients <span class="math notranslate nohighlight">\(A_λ\)</span> for each filter. Default: calculate from <code class="docutils literal notranslate"><span class="pre">ebv</span></code> and <code class="docutils literal notranslate"><span class="pre">rv</span></code>.</p>
</dd>
<dt><strong>hostext</strong><span class="classifier">dict, optional</span></dt><dd><p>Host galaxy extinction coefficients <span class="math notranslate nohighlight">\(A_λ\)</span> for each filter. Default: calculate from <code class="docutils literal notranslate"><span class="pre">host_ebv</span></code> and
<code class="docutils literal notranslate"><span class="pre">host_rv</span></code>.</p>
</dd>
<dt><strong>ebv</strong><span class="classifier">float, optional</span></dt><dd><p>Milky Way selective extinction <span class="math notranslate nohighlight">\(E(B-V)\)</span>, used if <code class="docutils literal notranslate"><span class="pre">extinction</span></code> is not given. Default: 0.</p>
</dd>
<dt><strong>host_ebv</strong><span class="classifier">float, optional</span></dt><dd><p>Host galaxy selective extinction <span class="math notranslate nohighlight">\(E(B-V)\)</span>, used if <code class="docutils literal notranslate"><span class="pre">hostext</span></code> is not given. Default: 0.</p>
</dd>
<dt><strong>rv</strong><span class="classifier">float, optional</span></dt><dd><p>Ratio of total to selective Milky Way extinction <span class="math notranslate nohighlight">\(R_V\)</span>, used with the <code class="docutils literal notranslate"><span class="pre">ebv</span></code> argument. Default: 3.1.</p>
</dd>
<dt><strong>host_rv</strong><span class="classifier">float, optional</span></dt><dd><p>Ratio of total to selective host-galaxy extinction <span class="math notranslate nohighlight">\(R_V\)</span>, used with the <code class="docutils literal notranslate"><span class="pre">host_ebv</span></code> argument.
Default: 3.1.</p>
</dd>
<dt><strong>redshift</strong><span class="classifier">float, optional</span></dt><dd><p>Redshift of the host galaxy. Used to redshift the filters for host galaxy extinction. If no distance
modulus is given, a redshift-dependent distance is calculated using the Planck18 cosmology. Default: 0.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.calcFlux">
<span class="sig-name descname"><span class="pre">calcFlux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nondetSigmas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.calcFlux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.calcFlux" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <code class="docutils literal notranslate"><span class="pre">'flux'</span></code> and <code class="docutils literal notranslate"><span class="pre">'dflux'</span></code> columns from the <code class="docutils literal notranslate"><span class="pre">'mag'</span></code> and <code class="docutils literal notranslate"><span class="pre">'dmag'</span></code> columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nondetSigmas</strong><span class="classifier">float, optional</span></dt><dd><p>Significance level implied by nondetections in the light curve. Default: 3σ</p>
</dd>
<dt><strong>zp</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Array of zero points for each magnitude. Default: standard for each filter</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.calcLum">
<span class="sig-name descname"><span class="pre">calcLum</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nondetSigmas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.calcLum"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.calcLum" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <code class="docutils literal notranslate"><span class="pre">'lum'</span></code> and <code class="docutils literal notranslate"><span class="pre">'dlum'</span></code> columns from the <code class="docutils literal notranslate"><span class="pre">'absmag'</span></code> and <code class="docutils literal notranslate"><span class="pre">'dmag'</span></code> columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nondetSigmas</strong><span class="classifier">float, optional</span></dt><dd><p>Significance level implied by nondetections in the light curve. Default: 3σ</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.calcMag">
<span class="sig-name descname"><span class="pre">calcMag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nondetSigmas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.calcMag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.calcMag" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the <code class="docutils literal notranslate"><span class="pre">'mag'</span></code> and <code class="docutils literal notranslate"><span class="pre">'dmag'</span></code> columns from the <code class="docutils literal notranslate"><span class="pre">'flux'</span></code> and <code class="docutils literal notranslate"><span class="pre">'dflux'</span></code> columns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nondetSigmas</strong><span class="classifier">float, optional</span></dt><dd><p>Significance level implied by nondetections in the light curve. Default: 3σ</p>
</dd>
<dt><strong>zp</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Array of zero points for each magnitude. Default: standard for each filter</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.calcPhase">
<span class="sig-name descname"><span class="pre">calcPhase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rdsp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.calcPhase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.calcPhase" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the rest-frame <code class="docutils literal notranslate"><span class="pre">'phase'</span></code> column from <code class="docutils literal notranslate"><span class="pre">'MJD'</span></code>, <code class="docutils literal notranslate"><span class="pre">.meta['refmjd']</span></code>, and <code class="docutils literal notranslate"><span class="pre">.meta['redshift']</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>rdsp</strong><span class="classifier">bool, optional</span></dt><dd><p>Define phase as rest-frame days since peak, rather than rest-frame days since explosion</p>
</dd>
<dt><strong>hours</strong><span class="classifier">bool, optional</span></dt><dd><p>Give the phase in rest-frame hours instead of rest-frame days</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.filters_to_objects">
<span class="sig-name descname"><span class="pre">filters_to_objects</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.filters_to_objects"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.filters_to_objects" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse the <code class="docutils literal notranslate"><span class="pre">'filter'</span></code> column into <code class="xref py py-class docutils literal notranslate"><span class="pre">filters.Filter</span></code> objects</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.findNondet">
<span class="sig-name descname"><span class="pre">findNondet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nondetSigmas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.findNondet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.findNondet" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a boolean column <code class="docutils literal notranslate"><span class="pre">'nondet'</span></code> indicating flux measurements that are below the detection threshold</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nondetSigmas</strong><span class="classifier">float, optional</span></dt><dd><p>Significance level implied by nondetections in the light curve. Default: 3σ</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.findPeak">
<span class="sig-name descname"><span class="pre">findPeak</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">criteria</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.findPeak"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.findPeak" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the peak of the light curve and store it in <code class="docutils literal notranslate"><span class="pre">.meta['peakdate']</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>criteria</strong><span class="classifier">dict, optional</span></dt><dd><p>Use only a subset of the light curve matching some criteria when calculating the peak date (stored in
<code class="docutils literal notranslate"><span class="pre">.meta['peakcriteria']</span></code>)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.get" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.normalize_column_names">
<span class="sig-name descname"><span class="pre">normalize_column_names</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.normalize_column_names"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.normalize_column_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Rename any recognizable columns to their standard names for this package (see <cite>lightcurve.column_names</cite>).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xcol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'phase'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ycol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'absmag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'filter'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_lines</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillmark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mjd_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">appmag_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_mark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">loc_filt</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncol_mark</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lgd_filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tight_layout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot the light curve, with nondetections marked with a downward-pointing arrow</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xcol</strong><span class="classifier">str, optional</span></dt><dd><p>Column to plot on the horizontal axis. Default: <code class="docutils literal notranslate"><span class="pre">'phase'</span></code></p>
</dd>
<dt><strong>ycol</strong><span class="classifier">str, optional</span></dt><dd><p>Column to plot on the vertical axis. Default: <code class="docutils literal notranslate"><span class="pre">'absmag'</span></code></p>
</dd>
<dt><strong>offset_factor</strong><span class="classifier">float, optional</span></dt><dd><p>Increase or decrease the filter offsets by a constant factor. Default: 1.</p>
</dd>
<dt><strong>color</strong><span class="classifier">str, optional</span></dt><dd><p>Column that controls the color of the lines and points. Default: <code class="docutils literal notranslate"><span class="pre">'filter'</span></code></p>
</dd>
<dt><strong>marker</strong><span class="classifier">str, optional</span></dt><dd><p>Column that controls the marker shape. Default: <code class="docutils literal notranslate"><span class="pre">'source'</span></code> or <code class="docutils literal notranslate"><span class="pre">'telescope'</span></code></p>
</dd>
<dt><strong>use_lines</strong><span class="classifier">bool, optional</span></dt><dd><p>Connect light curve points with lines. Default: False</p>
</dd>
<dt><strong>normalize</strong><span class="classifier">bool, optional</span></dt><dd><p>Normalize all light curves to peak at 0. Default: False</p>
</dd>
<dt><strong>fillmark</strong><span class="classifier">bool, optional</span></dt><dd><p>Fill each marker with color. Default: True</p>
</dd>
<dt><strong>mjd_axis</strong><span class="classifier">bool, optional</span></dt><dd><p>Plot MJD on the upper x-axis. Must have <code class="docutils literal notranslate"><span class="pre">.meta['redshift']</span></code> and <code class="docutils literal notranslate"><span class="pre">.meta['refmjd']</span></code>. Default: True.</p>
</dd>
<dt><strong>appmag_axis</strong><span class="classifier">bool, optional</span></dt><dd><p>Plot extinction-corrected apparent magnitude on the right y-axis. Must have <code class="docutils literal notranslate"><span class="pre">.meta['dm']</span></code>. Default: True.</p>
</dd>
<dt><strong>loc_mark, loc_filt</strong><span class="classifier">str, optional</span></dt><dd><p>Location for the marker and filter legends, respectively. Set to ‘none’ to omit them. Three new options are
available: ‘above’, ‘above left’, and ‘above right’. <code class="docutils literal notranslate"><span class="pre">mjd_axis</span></code> and/or <code class="docutils literal notranslate"><span class="pre">appmag_axis</span></code> must be used to
add these legends. Otherwise run <code class="docutils literal notranslate"><span class="pre">plt.legend()</span></code> after plotting for a single simple legend. Default: no
legend.</p>
</dd>
<dt><strong>ncol_mark</strong><span class="classifier">int, optional</span></dt><dd><p>Number of columns in the marker legend. Default: 1.</p>
</dd>
<dt><strong>lgd_filters</strong><span class="classifier">list, array-like, optional</span></dt><dd><p>Customize the arrangement of filters in the legend by providing a list of filters for each column. <code class="docutils literal notranslate"><span class="pre">None</span></code>
can be used to leave a blank space in the column. Only filters given here will be used. The default
arrangement shows all filters arranged by <code class="docutils literal notranslate"><span class="pre">.system</span></code> (columns) and <code class="docutils literal notranslate"><span class="pre">.offset</span></code> (rows).</p>
</dd>
<dt><strong>tight_layout</strong><span class="classifier">bool, optional</span></dt><dd><p>Adjust the figure margins to look beautiful. Default: True.</p>
</dd>
<dt><strong>kwargs</strong></dt><dd><p>Keyword arguments matching column names in the light curve are used to specify a subset of points to plot.
Additional keyword arguments passed to <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html#matplotlib.pyplot.plot" title="(in Matplotlib v3.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.plot()</span></code></a>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.read">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">format</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ascii'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fill_values</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read and parse a data table and return as a Table.</p>
<p>This function provides the Table interface to the astropy unified I/O
layer.  This allows easily reading a file in many supported data formats
using syntax such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;table.dat&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">events</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="s1">&#39;events.fits&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Get help on the available readers for <code class="docutils literal notranslate"><span class="pre">Table</span></code> using the``help()`` method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">help</span><span class="p">()</span>  <span class="c1"># Get help reading Table and list supported formats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">help</span><span class="p">(</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span>  <span class="c1"># Get detailed help on Table FITS reader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="o">.</span><span class="n">list_formats</span><span class="p">()</span>  <span class="c1"># Print list of available formats</span>
</pre></div>
</div>
<p>See also: <a class="reference external" href="https://docs.astropy.org/en/stable/io/unified.html">https://docs.astropy.org/en/stable/io/unified.html</a></p>
<dl class="field-list">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>*args</strong><span class="classifier">tuple, optional</span></dt><dd><p>Positional arguments passed through to data reader. If supplied the
first argument is typically the input filename.</p>
</dd>
<dt><strong>format</strong><span class="classifier">str</span></dt><dd><p>File format specifier.</p>
</dd>
<dt><strong>units</strong><span class="classifier">list, dict, optional</span></dt><dd><p>List or dict of units to apply to columns</p>
</dd>
<dt><strong>descriptions</strong><span class="classifier">list, dict, optional</span></dt><dd><p>List or dict of descriptions to apply to columns</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments passed through to data reader.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl>
<dt><strong>out</strong><span class="classifier"><cite>~astropy.table.Table</cite></span></dt><dd><p>Table corresponding to file contents</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The available built-in formats are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>Read</p></th>
<th class="head"><p>Write</p></th>
<th class="head"><p>Auto-identify</p></th>
<th class="head"><p>Deprecated</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ascii</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.aastex</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.basic</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.cds</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.commented_header</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.csv</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.daophot</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.ecsv</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.fast_basic</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.fast_commented_header</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.fast_csv</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.fast_no_header</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.fast_rdb</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.fast_tab</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.fixed_width</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.fixed_width_no_header</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.fixed_width_two_line</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.html</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.ipac</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.latex</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.mrt</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.no_header</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.qdp</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.rdb</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.rst</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.sextractor</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.tab</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>asdf</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>fits</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>hdf5</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>pandas.csv</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>pandas.fwf</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>pandas.html</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>pandas.json</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>parquet</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>votable</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>aastex</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>cds</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>csv</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>daophot</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>html</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>ipac</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>latex</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>mrt</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>rdb</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
<p>Deprecated format names like <code class="docutils literal notranslate"><span class="pre">aastex</span></code> will be removed in a future version. Use the full 
name (e.g. <code class="docutils literal notranslate"><span class="pre">ascii.aastex</span></code>) instead.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.where">
<span class="sig-name descname"><span class="pre">where</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.where"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.where" title="Permalink to this definition">¶</a></dt>
<dd><p>Select the subset of a light curve matching some criteria, given as keyword arguments, e.g., <code class="docutils literal notranslate"><span class="pre">colname=value</span></code>.</p>
<dl class="simple">
<dt>The keyword <code class="docutils literal notranslate"><span class="pre">colname</span></code> can be any of the following:</dt><dd><ul class="simple">
<li><p>a column in the table, in which case rows must match <code class="docutils literal notranslate"><span class="pre">value</span></code> in that column</p></li>
<li><p>a column in the table + <code class="docutils literal notranslate"><span class="pre">_not</span></code>, in which case rows must <em>not</em> match <code class="docutils literal notranslate"><span class="pre">value</span></code> in that column</p></li>
<li><p>a column in the table + <code class="docutils literal notranslate"><span class="pre">_min</span></code>, in which case rows must be &gt;= <code class="docutils literal notranslate"><span class="pre">value</span></code> in that column</p></li>
<li><p>a column in the table + <code class="docutils literal notranslate"><span class="pre">_max</span></code>, in which case rows must be &lt;= <code class="docutils literal notranslate"><span class="pre">value</span></code> in that column</p></li>
</ul>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">value</span></code> must match the data type of the column <code class="docutils literal notranslate"><span class="pre">colname</span></code> and can either be a single value or a list of
values. If <code class="docutils literal notranslate"><span class="pre">value</span></code> is a list, rows must match at least one of the values. If <code class="docutils literal notranslate"><span class="pre">value</span></code> is a list and
<code class="docutils literal notranslate"><span class="pre">colname</span></code> ends in <code class="docutils literal notranslate"><span class="pre">_not</span></code>, rows must not match any of the values.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#LC.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write this Table object out in the specified format.</p>
<p>This function provides the Table interface to the astropy unified I/O
layer.  This allows easily writing a file in many supported data formats
using syntax such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dat</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;table.dat&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Get help on the available writers for <code class="docutils literal notranslate"><span class="pre">Table</span></code> using the``help()`` method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Table</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">help</span><span class="p">()</span>  <span class="c1"># Get help writing Table and list supported formats</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Table</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">help</span><span class="p">(</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span>  <span class="c1"># Get detailed help on Table FITS writer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Table</span><span class="o">.</span><span class="n">write</span><span class="o">.</span><span class="n">list_formats</span><span class="p">()</span>  <span class="c1"># Print list of available formats</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">serialize_method</span></code> argument is explained in the section on
<a class="reference external" href="https://docs.astropy.org/en/latest/io/unified.html#table-serialization-methods">Table serialization methods</a>.</p>
<p>See also: <a class="reference external" href="https://docs.astropy.org/en/stable/io/unified.html">https://docs.astropy.org/en/stable/io/unified.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>*args</strong><span class="classifier">tuple, optional</span></dt><dd><p>Positional arguments passed through to data writer. If supplied the
first argument is the output filename.</p>
</dd>
<dt><strong>format</strong><span class="classifier">str</span></dt><dd><p>File format specifier.</p>
</dd>
<dt><strong>serialize_method</strong><span class="classifier">str, dict, optional</span></dt><dd><p>Serialization method specifier for columns.</p>
</dd>
<dt><strong>**kwargs</strong><span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments passed through to data writer.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The available built-in formats are:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Format</p></th>
<th class="head"><p>Read</p></th>
<th class="head"><p>Write</p></th>
<th class="head"><p>Auto-identify</p></th>
<th class="head"><p>Deprecated</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ascii</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.aastex</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.basic</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.commented_header</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.csv</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.ecsv</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.fast_basic</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.fast_commented_header</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.fast_csv</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.fast_no_header</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.fast_rdb</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.fast_tab</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.fixed_width</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.fixed_width_no_header</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.fixed_width_two_line</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.html</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.ipac</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.latex</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.mrt</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.no_header</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.qdp</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.rdb</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>ascii.rst</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>ascii.tab</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>asdf</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>fits</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>hdf5</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>jsviewer</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>pandas.csv</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>pandas.html</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>pandas.json</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>parquet</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>votable</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>aastex</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>csv</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>html</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>ipac</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>latex</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-even"><td><p>mrt</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
<tr class="row-odd"><td><p>rdb</p></td>
<td><p>Yes</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
</tr>
</tbody>
</table>
<p>Deprecated format names like <code class="docutils literal notranslate"><span class="pre">aastex</span></code> will be removed in a future version. Use the full 
name (e.g. <code class="docutils literal notranslate"><span class="pre">ascii.aastex</span></code>) instead.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.LC.zp">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">zp</span></span><a class="headerlink" href="#lightcurve_fitting.lightcurve.LC.zp" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns an array of zero points for each filter in the <code class="docutils literal notranslate"><span class="pre">'filter'</span></code> column</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.aux_axes">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.lightcurve.</span></span><span class="sig-name descname"><span class="pre">aux_axes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yfunc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xfunc_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">yfunc_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#aux_axes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.aux_axes" title="Permalink to this definition">¶</a></dt>
<dd><p>Add auxiliary axes to a plot that are linear transformations of the existing axes</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>xfunc</strong><span class="classifier">function, optional</span></dt><dd><p>Function that transforms the lower x-axis to the upper x-axis. Default: do not add an upper x-axis.</p>
</dd>
<dt><strong>yfunc</strong><span class="classifier">function, optional</span></dt><dd><p>Function that transforms the left y-axis to the right y-axis. Default: do not add a right y-axis.</p>
</dd>
<dt><strong>ax0</strong><span class="classifier">matplotlib.pyplot.Axes, optional</span></dt><dd><p>Existing axes object. Default: use the current Axes.</p>
</dd>
<dt><strong>xfunc_args, yfunc_args</strong><span class="classifier">dict, optional</span></dt><dd><p>Keyword arguments for <code class="docutils literal notranslate"><span class="pre">xfunc</span></code> and <code class="docutils literal notranslate"><span class="pre">yfunc</span></code>, respectively</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>top</strong><span class="classifier">matplotlib.pyplot.Axes</span></dt><dd><p>The upper x-axis, if any. Otherwise, None.</p>
</dd>
<dt><strong>right</strong><span class="classifier">matplotlib.pyplot.Axes</span></dt><dd><p>The right y-axis, if any. Otherwise, None.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.binflux">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.lightcurve.</span></span><span class="sig-name descname"><span class="pre">binflux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">time</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dflux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_zero</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#binflux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.binflux" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin a light curve by averaging points within <code class="docutils literal notranslate"><span class="pre">delta</span></code> of each other in time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>time, flux, dflux</strong><span class="classifier">array-like</span></dt><dd><p>Arrays of times, fluxes, and uncertainties comprising the observed light curve</p>
</dd>
<dt><strong>delta</strong><span class="classifier">float, optional</span></dt><dd><p>Bin size, in the same units as <code class="docutils literal notranslate"><span class="pre">time</span></code>. Default: 0.2</p>
</dd>
<dt><strong>include_zero</strong><span class="classifier">bool, optional</span></dt><dd><p>Include data points with no error bar</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>time, flux, dflux</strong><span class="classifier">array-like</span></dt><dd><p>Binned arrays of times, fluxes, and uncertainties</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.custom_legend">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.lightcurve.</span></span><span class="sig-name descname"><span class="pre">custom_legend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">handles</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">top_axis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#custom_legend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.custom_legend" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a legend to the axes with options for <code class="docutils literal notranslate"><span class="pre">loc='above'</span></code>, <code class="docutils literal notranslate"><span class="pre">loc='above</span> <span class="pre">left'</span></code>, and <code class="docutils literal notranslate"><span class="pre">loc='above</span> <span class="pre">right'</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>ax</strong><span class="classifier">matplotlib.pyplot.Axes, matplotlib.pyplot.Figure</span></dt><dd><p>Axes or Figure object to which to add the legend</p>
</dd>
<dt><strong>handles</strong><span class="classifier">list of matplotlib.pyplot.Artist</span></dt><dd><p>A list of Artists (lines, patches) to be added to the legend</p>
</dd>
<dt><strong>labels</strong><span class="classifier">list of str</span></dt><dd><p>A list of labels to show next to the handles</p>
</dd>
<dt><strong>top_axis</strong><span class="classifier">bool, optional</span></dt><dd><p>For legends above the top of the plot, add extra padding to the upper x-axis labels. Default: True.</p>
</dd>
<dt><strong>kwargs</strong></dt><dd><p>Keyword arguments to be passed to <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.legend.html#matplotlib.pyplot.legend" title="(in Matplotlib v3.7.1)"><code class="xref py py-func docutils literal notranslate"><span class="pre">matplotlib.pyplot.legend()</span></code></a></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>lgd</strong><span class="classifier">matplotlib.legend.Legend</span></dt><dd><p>The Legend object</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.filter_legend">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.lightcurve.</span></span><span class="sig-name descname"><span class="pre">filter_legend</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filts</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">offset_factor</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#filter_legend"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.filter_legend" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates dummy artists and labels for the filter legend using the filter properties</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filts</strong><span class="classifier">set, list, array-like</span></dt><dd><p>If a list or array of strings, the arrangement of filters in the legend, with columns in the first dimension and
rows in the second. If a set of <a class="reference internal" href="#lightcurve_fitting.filters.Filter" title="lightcurve_fitting.filters.Filter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Filter</span></code></a> objects, they will first be arranged using <a class="reference internal" href="#lightcurve_fitting.lightcurve.filtsetup" title="lightcurve_fitting.lightcurve.filtsetup"><code class="xref py py-func docutils literal notranslate"><span class="pre">filtsetup()</span></code></a>.</p>
</dd>
<dt><strong>offset_factor</strong><span class="classifier">float, optional</span></dt><dd><p>Increase or decrease the filter offsets by a constant factor. Default: 1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>lines</strong><span class="classifier">list of matplotlib.pyplot.Artist</span></dt><dd><p>A list of Artists (lines, patches) to be added to the legend</p>
</dd>
<dt><strong>labels</strong><span class="classifier">list of str</span></dt><dd><p>A list of labels to show next to the handles</p>
</dd>
<dt><strong>ncol</strong><span class="classifier">int</span></dt><dd><p>Number of columns needed for the filter legend</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.filtsetup">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.lightcurve.</span></span><span class="sig-name descname"><span class="pre">filtsetup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filts</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#filtsetup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.filtsetup" title="Permalink to this definition">¶</a></dt>
<dd><p>Arrange filters in a grid according to their system (columns) and offset (rows)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filts</strong><span class="classifier">set</span></dt><dd><p>A set of <a class="reference internal" href="#lightcurve_fitting.filters.Filter" title="lightcurve_fitting.filters.Filter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Filter</span></code></a> objects to be arranged</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>lgnd</strong><span class="classifier">numpy.array</span></dt><dd><p>A 2D array of <a class="reference internal" href="#lightcurve_fitting.filters.Filter" title="lightcurve_fitting.filters.Filter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Filter</span></code></a> objects</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.flux2mag">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.lightcurve.</span></span><span class="sig-name descname"><span class="pre">flux2mag</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dflux</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">array(nan)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nondet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nondetSigmas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#flux2mag"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.flux2mag" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert flux (and uncertainty) to magnitude (and uncertainty). Nondetections are converted to limiting magnitudes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>flux</strong><span class="classifier">float, array-like</span></dt><dd><p>Flux to be converted</p>
</dd>
<dt><strong>dflux</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Uncertainty on the flux to be converted. Default: <code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy.nan</span></code></p>
</dd>
<dt><strong>zp</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Zero point to be applied to the magnitudes</p>
</dd>
<dt><strong>nondet</strong><span class="classifier">array-like</span></dt><dd><p>Boolean or index array indicating the nondetections among the fluxes. Default: no nondetections</p>
</dd>
<dt><strong>nondetSigmas</strong><span class="classifier">float, optional</span></dt><dd><p>Significance level implied by nondetections in the light curve. Default: 3σ</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>mag</strong><span class="classifier">float, array-like</span></dt><dd><p>Magnitude corresponding to the input flux</p>
</dd>
<dt><strong>dmag</strong><span class="classifier">float, array-like</span></dt><dd><p>Uncertainty on the output magnitude</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.lightcurve.mag2flux">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.lightcurve.</span></span><span class="sig-name descname"><span class="pre">mag2flux</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mag</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dmag</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nan</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nondet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nondetSigmas</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">3.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/lightcurve.html#mag2flux"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.lightcurve.mag2flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert magnitude (and uncertainty) to flux (and uncertainty). Nondetections are assumed to imply zero flux.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>mag</strong><span class="classifier">float, array-like</span></dt><dd><p>Magnitude to be converted</p>
</dd>
<dt><strong>dmag</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Uncertainty on the magnitude to be converted. Default: <code class="xref py py-mod docutils literal notranslate"><span class="pre">numpy.nan</span></code></p>
</dd>
<dt><strong>zp</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Zero point to be applied to the magnitudes</p>
</dd>
<dt><strong>nondet</strong><span class="classifier">array-like</span></dt><dd><p>Boolean or index array indicating the nondetections among the fluxes. Default: no nondetections</p>
</dd>
<dt><strong>nondetSigmas</strong><span class="classifier">float, optional</span></dt><dd><p>Significance level implied by nondetections in the light curve. Default: 3σ</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>flux</strong><span class="classifier">float, array-like</span></dt><dd><p>Flux corresponding to the input magnitude</p>
</dd>
<dt><strong>dflux</strong><span class="classifier">float, array-like</span></dt><dd><p>Uncertainty on the output flux</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-lightcurve_fitting.models">
<span id="lightcurve-fitting-models-module"></span><h2>lightcurve_fitting.models module<a class="headerlink" href="#module-lightcurve_fitting.models" title="Permalink to this heading">¶</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseCompanionShocking">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">BaseCompanionShocking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseCompanionShocking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseCompanionShocking" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightcurve_fitting.models.Model" title="lightcurve_fitting.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p>The companion shocking model of Kasen (<a class="reference external" href="https://doi.org/10.1088/0004-637X/708/2/1025">https://doi.org/10.1088/0004-637X/708/2/1025</a>) plus the SiFTO SN Ia model.</p>
<p>As written by Hosseinzadeh et al. (<a class="reference external" href="https://doi.org/10.3847/2041-8213/aa8402">https://doi.org/10.3847/2041-8213/aa8402</a>), the shock component is defined by:</p>
<p><span class="math notranslate nohighlight">\(R_\mathrm{phot}(t) = (2700\,R_\odot) (M_c v_9^7)^{1/9} κ^{1/9} t^{7/9}\)</span> (Eq. 1)</p>
<p><span class="math notranslate nohighlight">\(T_\mathrm{eff}(t) = (25\,\mathrm{kK}) a_{13}^{1/4} (M_c v_9^7)^{1/144} κ^{-35/144} t^{37/72}\)</span> (Eq. 2)</p>
<p>The SiFTO model (<a class="reference external" href="https://doi.org/10.1086/588518">https://doi.org/10.1086/588518</a>) is currently only available in the UBVgri filters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lc</strong><span class="classifier">lightcurve_fitting.lightcurve.LC, optional</span></dt><dd><p>The light curve to which the model will be fit. Only used for <cite>lc.meta[‘redshift’]</cite> if <cite>z</cite> is not given.</p>
</dd>
<dt><strong>redshift</strong><span class="classifier">float, optional</span></dt><dd><p>The redshift between blackbody source and the observed filters. Default: 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z</strong><span class="classifier">float</span></dt><dd><p>The redshift between blackbody source and the observed filters</p>
</dd>
<dt><strong>sifto</strong><span class="classifier">astropy.table.Table</span></dt><dd><p>A copy of the SiFTO model scaled to match the observed peak luminosity in each filter</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseCompanionShocking.companion_shocking">
<span class="sig-name descname"><span class="pre">companion_shocking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mc_v9_7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseCompanionShocking.companion_shocking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseCompanionShocking.companion_shocking" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the shock component only at a range of times and filters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_in</strong><span class="classifier">float, array-like</span></dt><dd><p>Time in days</p>
</dd>
<dt><strong>f</strong><span class="classifier">lightcurve_fitting.filter.Filter, array-like</span></dt><dd><p>Filters for which to calculate the model</p>
</dd>
<dt><strong>t_exp</strong><span class="classifier">float, array-like</span></dt><dd><p>The explosion epoch</p>
</dd>
<dt><strong>a13</strong><span class="classifier">float, array-like</span></dt><dd><p>The binary separation in <span class="math notranslate nohighlight">\(10^{13}\)</span> cm</p>
</dd>
<dt><strong>Mc_v9_7</strong><span class="classifier">float, array-like</span></dt><dd><p>The product <span class="math notranslate nohighlight">\(M_c v_9^7\)</span>, where <span class="math notranslate nohighlight">\(M_c\)</span> is the ejecta mass in Chandrasekhar masses and <span class="math notranslate nohighlight">\(v_9\)</span> is
the ejecta velocity in units of <span class="math notranslate nohighlight">\(10^9\)</span> cm/s</p>
</dd>
<dt><strong>kappa</strong><span class="classifier">float, array-like</span></dt><dd><p>The ejecta opacity in units of the electron scattering opacity (0.34 cm^2/g)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_fit</strong><span class="classifier">array-like</span></dt><dd><p>The filtered model light curves</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseCompanionShocking.evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseCompanionShocking.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseCompanionShocking.evaluate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseCompanionShocking.stretched_sifto">
<span class="sig-name descname"><span class="pre">stretched_sifto</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dti</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseCompanionShocking.stretched_sifto"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseCompanionShocking.stretched_sifto" title="Permalink to this definition">¶</a></dt>
<dd><p>The SiFTO SN Ia model (<a class="reference external" href="https://doi.org/10.1086/588518">https://doi.org/10.1086/588518</a>), offset and stretched by the input parameters</p>
<p>The SiFTO model is currently only available in the UBVgri filters. We assume unfiltered photometry can be
modeled as r.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_in</strong><span class="classifier">float, array-like</span></dt><dd><p>Time in days</p>
</dd>
<dt><strong>f</strong><span class="classifier">lightcurve_fitting.filter.Filter, array-like</span></dt><dd><p>Filters for which to calculate the model</p>
</dd>
<dt><strong>t_peak</strong><span class="classifier">float, array-like</span></dt><dd><p>The epoch of maximum light for the SiFTO model</p>
</dd>
<dt><strong>stretch</strong><span class="classifier">float, array-like</span></dt><dd><p>The stretch for the SiFTO model</p>
</dd>
<dt><strong>dtU, dti</strong><span class="classifier">float, array-like</span></dt><dd><p>Time offsets for the U- and i-band models relative to the other bands</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_fit</strong><span class="classifier">array-like</span></dt><dd><p>The filtered model light curves</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseCompanionShocking.t_max">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseCompanionShocking.t_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseCompanionShocking.t_max" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum time at which the model is valid</p>
<p>This is the last epoch at which the stretched SiFTO model is computed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseCompanionShocking.t_min">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseCompanionShocking.t_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseCompanionShocking.t_min" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum time at which the model is valid</p>
<p>This is the first epoch at which the stretched SiFTO model is computed</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseCompanionShocking.temperature_radius">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">temperature_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mc_v9_7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseCompanionShocking.temperature_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseCompanionShocking.temperature_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the color temperature and photospheric radius of the shock component as a function of time</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_in</strong><span class="classifier">float, array-like</span></dt><dd><p>Time in days</p>
</dd>
<dt><strong>t_exp</strong><span class="classifier">float, array-like</span></dt><dd><p>The explosion epoch</p>
</dd>
<dt><strong>a13</strong><span class="classifier">float, array-like</span></dt><dd><p>The binary separation in <span class="math notranslate nohighlight">\(10^{13}\)</span> cm</p>
</dd>
<dt><strong>Mc_v9_7</strong><span class="classifier">float, array-like</span></dt><dd><p>The product <span class="math notranslate nohighlight">\(M_c v_9^7\)</span>, where <span class="math notranslate nohighlight">\(M_c\)</span> is the ejecta mass in Chandrasekhar masses and <span class="math notranslate nohighlight">\(v_9\)</span>
is the ejecta velocity in units of <span class="math notranslate nohighlight">\(10^9\)</span> cm/s</p>
</dd>
<dt><strong>kappa</strong><span class="classifier">float, array-like</span></dt><dd><p>The ejecta opacity in units of the electron scattering opacity (0.34 cm^2/g)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>T_kasen</strong><span class="classifier">array-like</span></dt><dd><p>The model blackbody temperatures in units of kilokelvins</p>
</dd>
<dt><strong>R_kasen</strong><span class="classifier">array-like</span></dt><dd><p>The model blackbody radii in units of 1000 solar radii</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseShockCooling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">BaseShockCooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseShockCooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseShockCooling" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightcurve_fitting.models.Model" title="lightcurve_fitting.models.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">Model</span></code></a></p>
<p>The shock cooling model of Sapir &amp; Waxman (<a class="reference external" href="https://doi.org/10.3847/1538-4357/aa64df">https://doi.org/10.3847/1538-4357/aa64df</a>).</p>
<p><span class="math notranslate nohighlight">\(T(t) = \frac{T_\mathrm{col}}{T_\mathrm{ph}} T_0 \left(\frac{v_s^2 t^2}{f_ρ M κ}\right)^{ε_1}
\frac{R^{1/4}}{κ^{1/4}} t^{-1/2}\)</span> (Eq. 23)</p>
<p><span class="math notranslate nohighlight">\(L(t) = A \exp\left[-\left(\frac{a t}{t_\mathrm{tr}}\right)^α\right]
L_0 \left(\frac{v_s t^2}{f_ρ M κ}\right)^{-ε_2} \frac{v_s^2 R}{κ}\)</span> (Eq. 18-19)</p>
<p><span class="math notranslate nohighlight">\(t_\mathrm{tr} = (19.5\,\mathrm{d}) \left(\frac{κ * M_\mathrm{env}}{v_s} \right)^{1/2}\)</span> (Eq. 20)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lc</strong><span class="classifier">lightcurve_fitting.lightcurve.LC, optional</span></dt><dd><p>The light curve to which the model will be fit. Only used to get the redshift if <cite>redshift</cite> is not given.</p>
</dd>
<dt><strong>redshift</strong><span class="classifier">float, optional</span></dt><dd><p>The redshift between blackbody source and the observed filters. Default: 0.</p>
</dd>
<dt><strong>n</strong><span class="classifier">float, optional</span></dt><dd><p>The polytropic index of the progenitor. Must be either 1.5 (default) or 3.</p>
</dd>
<dt><strong>RW</strong><span class="classifier">bool, optional</span></dt><dd><p>Reduce the model to the simpler form of Rabinak &amp; Waxman (<a class="reference external" href="https://doi.org/10.1088/0004-637X/728/1/63">https://doi.org/10.1088/0004-637X/728/1/63</a>).
Default: False.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Attributes<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>z</strong><span class="classifier">float</span></dt><dd><p>The redshift between blackbody source and the observed filters</p>
</dd>
<dt><strong>n</strong><span class="classifier">float</span></dt><dd><p>The polytropic index of the progenitor</p>
</dd>
<dt><strong>A</strong><span class="classifier">float</span></dt><dd><p>Coefficient on the luminosity suppression factor (Eq. 19)</p>
</dd>
<dt><strong>a</strong><span class="classifier">float</span></dt><dd><p>Coefficient on the transparency timescale (Eq. 19)</p>
</dd>
<dt><strong>alpha</strong><span class="classifier">float</span></dt><dd><p>Exponent on the transparency timescale (Eq. 19)</p>
</dd>
<dt><strong>epsilon_1</strong><span class="classifier">float</span></dt><dd><p>Exponent in the temperature expression (Eq. 23)</p>
</dd>
<dt><strong>epsilon_2</strong><span class="classifier">float</span></dt><dd><p>Exponent in the luminosity expression (Eq. 18)</p>
</dd>
<dt><strong>L_0</strong><span class="classifier">float</span></dt><dd><p>Coefficient on the luminosity expression in erg/s (Eq. 18)</p>
</dd>
<dt><strong>T_0</strong><span class="classifier">float</span></dt><dd><p>Coefficient on the temperature expression in eV (Eq. 23)</p>
</dd>
<dt><strong>Tph_to_Tcol</strong><span class="classifier">float</span></dt><dd><p>Ratio of the color temperature to the photospheric temperature</p>
</dd>
<dt><strong>epsilon_T</strong><span class="classifier">float</span></dt><dd><p>Exponent on time in the temperature expression</p>
</dd>
<dt><strong>epsilon_L</strong><span class="classifier">float</span></dt><dd><p>Exponent on time in the luminosity expression</p>
</dd>
<dt><strong>RW</strong><span class="classifier">bool</span></dt><dd><p>Reduce the model to the simpler form of Rabinak &amp; Waxman (<a class="reference external" href="https://doi.org/10.1088/0004-637X/728/1/63">https://doi.org/10.1088/0004-637X/728/1/63</a>)</p>
</dd>
</dl>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseShockCooling.evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseShockCooling.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseShockCooling.evaluate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseShockCooling.t_max">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseShockCooling.t_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseShockCooling.t_max" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum time at which the model is valid</p>
<p><span class="math notranslate nohighlight">\(t_\mathrm{max} = (7.4\,\mathrm{d}) \left(\frac{R}{κ}\right)^{0.55} + t_\mathrm{exp}\)</span> (Eq. 24)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseShockCooling.t_min">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseShockCooling.t_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseShockCooling.t_min" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum time at which the model is valid</p>
<p><span class="math notranslate nohighlight">\(t_\mathrm{min} = (0.2\,\mathrm{d}) \frac{R}{v_s}
\max\left[0.5, \frac{R^{0.4}}{(f_ρ M κ)^{0.2} v_s^{-0.7}}\right] + t_\mathrm{exp}\)</span> (Eq. 17)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.BaseShockCooling.temperature_radius">
<span class="sig-name descname"><span class="pre">temperature_radius</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M_env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_rho_M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#BaseShockCooling.temperature_radius"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.BaseShockCooling.temperature_radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the color temperature and photospheric radius as a function of time for a set of parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_in</strong><span class="classifier">float, array-like</span></dt><dd><p>Time in days</p>
</dd>
<dt><strong>v_s</strong><span class="classifier">float, array-like</span></dt><dd><p>The shock speed in <span class="math notranslate nohighlight">\(10^{8.5}\)</span> cm/s</p>
</dd>
<dt><strong>M_env</strong><span class="classifier">float, array-like</span></dt><dd><p>The envelope mass in solar masses</p>
</dd>
<dt><strong>f_rho_M</strong><span class="classifier">float, array-like</span></dt><dd><p>The product <span class="math notranslate nohighlight">\(f_ρ M\)</span>, where <span class="math notranslate nohighlight">\(f_ρ\)</span> is a numerical factor of order unity that depends on the inner
envelope structure and <span class="math notranslate nohighlight">\(M\)</span> is the ejecta mass in solar masses</p>
</dd>
<dt><strong>R</strong><span class="classifier">float, array-like</span></dt><dd><p>The progenitor radius in <span class="math notranslate nohighlight">\(10^{13}\)</span> cm</p>
</dd>
<dt><strong>t_exp</strong><span class="classifier">float, array-like</span></dt><dd><p>The explosion epoch</p>
</dd>
<dt><strong>kappa</strong><span class="classifier">float, array-like</span></dt><dd><p>The ejecta opacity in units of the electron scattering opacity (0.34 cm^2/g)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>T_K</strong><span class="classifier">array-like</span></dt><dd><p>The model blackbody temperatures in units of kilokelvins</p>
</dd>
<dt><strong>R_bb</strong><span class="classifier">array-like</span></dt><dd><p>The model blackbody radii in units of 1000 solar radii</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">CompanionShocking</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#CompanionShocking"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightcurve_fitting.models.BaseCompanionShocking" title="lightcurve_fitting.models.BaseCompanionShocking"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCompanionShocking</span></code></a></p>
<p>The companion shocking model of Kasen (<a class="reference external" href="https://doi.org/10.1088/0004-637X/708/2/1025">https://doi.org/10.1088/0004-637X/708/2/1025</a>) plus the SiFTO SN Ia model.</p>
<p>This version of the model includes factors on the r and i SiFTO models, and a factor on the U shock component.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mc_v9_7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ri</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#CompanionShocking.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate this model at a range of times and filters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_in</strong><span class="classifier">float, array-like</span></dt><dd><p>Time in days</p>
</dd>
<dt><strong>f</strong><span class="classifier">lightcurve_fitting.filter.Filter, array-like</span></dt><dd><p>Filters for which to calculate the model</p>
</dd>
<dt><strong>t_exp</strong><span class="classifier">float, array-like</span></dt><dd><p>The explosion epoch</p>
</dd>
<dt><strong>a13</strong><span class="classifier">float, array-like</span></dt><dd><p>The binary separation in <span class="math notranslate nohighlight">\(10^{13}\)</span> cm</p>
</dd>
<dt><strong>Mc_v9_7</strong><span class="classifier">float, array-like</span></dt><dd><p>The product <span class="math notranslate nohighlight">\(M_c v_9^7\)</span>, where <span class="math notranslate nohighlight">\(M_c\)</span> is the ejecta mass in Chandrasekhar masses and <span class="math notranslate nohighlight">\(v_9\)</span> is
the ejecta velocity in units of <span class="math notranslate nohighlight">\(10^9\)</span> cm/s</p>
</dd>
<dt><strong>t_peak</strong><span class="classifier">float, array-like</span></dt><dd><p>The epoch of maximum light for the SiFTO model</p>
</dd>
<dt><strong>stretch</strong><span class="classifier">float, array-like</span></dt><dd><p>The stretch for the SiFTO model</p>
</dd>
<dt><strong>rr</strong><span class="classifier">float, array-like</span></dt><dd><p>A scale factor for the r-band SiFTO model</p>
</dd>
<dt><strong>ri</strong><span class="classifier">float, array-like</span></dt><dd><p>A scale factor for the i-band SiFTO model</p>
</dd>
<dt><strong>rU</strong><span class="classifier">float, aray-like</span></dt><dd><p>A scale factor for the U-band of the shock component</p>
</dd>
<dt><strong>kappa</strong><span class="classifier">float, array-like</span></dt><dd><p>The ejecta opacity in units of the electron scattering opacity (0.34 cm^2/g)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_fit</strong><span class="classifier">array-like</span></dt><dd><p>The filtered model light curves</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking.input_names">
<span class="sig-name descname"><span class="pre">input_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['t_0',</span> <span class="pre">'a',</span> <span class="pre">'M</span> <span class="pre">v^7',</span> <span class="pre">'t_\\mathrm{max}',</span> <span class="pre">'s',</span> <span class="pre">'r_r',</span> <span class="pre">'r_i',</span> <span class="pre">'r_U']</span></em><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking.input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the parameter names</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking.units">
<span class="sig-name descname"><span class="pre">units</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[Unit(&quot;d&quot;),</span> <span class="pre">&lt;Quantity</span> <span class="pre">1.e+13</span> <span class="pre">cm&gt;,</span> <span class="pre">&lt;Quantity</span> <span class="pre">1.e+63</span> <span class="pre">cm7</span> <span class="pre">M_chandra</span> <span class="pre">/</span> <span class="pre">s7&gt;,</span> <span class="pre">Unit(&quot;d&quot;),</span> <span class="pre">Unit(dimensionless),</span> <span class="pre">Unit(dimensionless),</span> <span class="pre">Unit(dimensionless),</span> <span class="pre">Unit(dimensionless)]</span></em><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking.units" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the units for each parameter</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">CompanionShocking2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#CompanionShocking2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightcurve_fitting.models.BaseCompanionShocking" title="lightcurve_fitting.models.BaseCompanionShocking"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCompanionShocking</span></code></a></p>
<p>The companion shocking model of Kasen (<a class="reference external" href="https://doi.org/10.1088/0004-637X/708/2/1025">https://doi.org/10.1088/0004-637X/708/2/1025</a>) plus the SiFTO SN Ia model.</p>
<p>This version of the model includes time offsets for the U and i SiFTO models.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking2.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Mc_v9_7</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtU</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dti</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#CompanionShocking2.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking2.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate this model at a range of times and filters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_in</strong><span class="classifier">float, array-like</span></dt><dd><p>Time in days</p>
</dd>
<dt><strong>f</strong><span class="classifier">lightcurve_fitting.filter.Filter, array-like</span></dt><dd><p>Filters for which to calculate the model</p>
</dd>
<dt><strong>t_exp</strong><span class="classifier">float, array-like</span></dt><dd><p>The explosion epoch</p>
</dd>
<dt><strong>a13</strong><span class="classifier">float, array-like</span></dt><dd><p>The binary separation in <span class="math notranslate nohighlight">\(10^{13}\)</span> cm</p>
</dd>
<dt><strong>Mc_v9_7</strong><span class="classifier">float, array-like</span></dt><dd><p>The product <span class="math notranslate nohighlight">\(M_c v_9^7\)</span>, where <span class="math notranslate nohighlight">\(M_c\)</span> is the ejecta mass in Chandrasekhar masses and <span class="math notranslate nohighlight">\(v_9\)</span> is
the ejecta velocity in units of <span class="math notranslate nohighlight">\(10^9\)</span> cm/s</p>
</dd>
<dt><strong>t_peak</strong><span class="classifier">float, array-like</span></dt><dd><p>The epoch of maximum light for the SiFTO model</p>
</dd>
<dt><strong>stretch</strong><span class="classifier">float, array-like</span></dt><dd><p>The stretch for the SiFTO model</p>
</dd>
<dt><strong>dtU, dti</strong><span class="classifier">float, array-like</span></dt><dd><p>Time offsets for the U- and i-band SiFTO models relative to the other bands</p>
</dd>
<dt><strong>kappa</strong><span class="classifier">float, array-like</span></dt><dd><p>The ejecta opacity in units of the electron scattering opacity (0.34 cm^2/g)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_fit</strong><span class="classifier">array-like</span></dt><dd><p>The filtered model light curves</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking2.input_names">
<span class="sig-name descname"><span class="pre">input_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['t_0',</span> <span class="pre">'a',</span> <span class="pre">'M</span> <span class="pre">v^7',</span> <span class="pre">'t_\\mathrm{max}',</span> <span class="pre">'s',</span> <span class="pre">'\\Delta</span> <span class="pre">t_U',</span> <span class="pre">'\\Delta</span> <span class="pre">t_i']</span></em><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking2.input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the parameter names</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking2.units">
<span class="sig-name descname"><span class="pre">units</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[Unit(&quot;d&quot;),</span> <span class="pre">&lt;Quantity</span> <span class="pre">1.e+13</span> <span class="pre">cm&gt;,</span> <span class="pre">&lt;Quantity</span> <span class="pre">1.e+63</span> <span class="pre">cm7</span> <span class="pre">M_chandra</span> <span class="pre">/</span> <span class="pre">s7&gt;,</span> <span class="pre">Unit(&quot;d&quot;),</span> <span class="pre">Unit(dimensionless),</span> <span class="pre">Unit(&quot;d&quot;),</span> <span class="pre">Unit(&quot;d&quot;)]</span></em><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking2.units" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the units for each parameter</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">CompanionShocking3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#CompanionShocking3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightcurve_fitting.models.BaseCompanionShocking" title="lightcurve_fitting.models.BaseCompanionShocking"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseCompanionShocking</span></code></a></p>
<p>The companion shocking model of Kasen (<a class="reference external" href="https://doi.org/10.1088/0004-637X/708/2/1025">https://doi.org/10.1088/0004-637X/708/2/1025</a>) plus the SiFTO SN Ia model.</p>
<p>This version of the model includes time offsets for the U and i SiFTO models, as well as the viewing angle
dependence parametrized by Brown et al. (<a class="reference external" href="https://doi.org/10.1088/0004-637X/749/1/18">https://doi.org/10.1088/0004-637X/749/1/18</a>).</p>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking3.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">a13</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_peak</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stretch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtU</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dti</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#CompanionShocking3.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking3.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate this model at a range of times and filters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_in</strong><span class="classifier">float, array-like</span></dt><dd><p>Time in days</p>
</dd>
<dt><strong>f</strong><span class="classifier">lightcurve_fitting.filter.Filter, array-like</span></dt><dd><p>Filters for which to calculate the model</p>
</dd>
<dt><strong>t_exp</strong><span class="classifier">float, array-like</span></dt><dd><p>The explosion epoch</p>
</dd>
<dt><strong>a13</strong><span class="classifier">float, array-like</span></dt><dd><p>The binary separation in <span class="math notranslate nohighlight">\(10^{13}\)</span> cm</p>
</dd>
<dt><strong>theta</strong><span class="classifier">float, array-like</span></dt><dd><p>The angle between the binary axis and the line to the observer in degrees. 0° means the binary companion
is along the line of sight.</p>
</dd>
<dt><strong>t_peak</strong><span class="classifier">float, array-like</span></dt><dd><p>The epoch of maximum light for the SiFTO model</p>
</dd>
<dt><strong>stretch</strong><span class="classifier">float, array-like</span></dt><dd><p>The stretch for the SiFTO model</p>
</dd>
<dt><strong>dtU, dti</strong><span class="classifier">float, array-like</span></dt><dd><p>Time offsets for the U- and i-band SiFTO models relative to the other bands</p>
</dd>
<dt><strong>kappa</strong><span class="classifier">float, array-like</span></dt><dd><p>The ejecta opacity in units of the electron scattering opacity (0.34 cm^2/g)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_fit</strong><span class="classifier">array-like</span></dt><dd><p>The filtered model light curves</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking3.input_names">
<span class="sig-name descname"><span class="pre">input_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['t_0',</span> <span class="pre">'a',</span> <span class="pre">'\\theta',</span> <span class="pre">'t_\\mathrm{max}',</span> <span class="pre">'s',</span> <span class="pre">'\\Delta</span> <span class="pre">t_U',</span> <span class="pre">'\\Delta</span> <span class="pre">t_i']</span></em><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking3.input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the parameter names</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.CompanionShocking3.units">
<span class="sig-name descname"><span class="pre">units</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[Unit(&quot;d&quot;),</span> <span class="pre">&lt;Quantity</span> <span class="pre">1.e+13</span> <span class="pre">cm&gt;,</span> <span class="pre">Unit(&quot;deg&quot;),</span> <span class="pre">Unit(&quot;d&quot;),</span> <span class="pre">Unit(dimensionless),</span> <span class="pre">Unit(&quot;d&quot;),</span> <span class="pre">Unit(&quot;d&quot;)]</span></em><a class="headerlink" href="#lightcurve_fitting.models.CompanionShocking3.units" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the units for each parameter</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.GaussianPrior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">GaussianPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stddev</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#GaussianPrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.GaussianPrior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightcurve_fitting.models.Prior" title="lightcurve_fitting.models.Prior"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prior</span></code></a></p>
<p>A Gaussian prior centered at <cite>mean</cite> with standard deviation <cite>stddev</cite>, i.e.,
<span class="math notranslate nohighlight">\(\frac{dP}{dp} \propto \exp \left( \frac{(p - \mu)^2}{2 \sigma^2} \right)\)</span></p>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.GaussianPrior.logp">
<span class="sig-name descname"><span class="pre">logp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#GaussianPrior.logp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.GaussianPrior.logp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.LogUniformPrior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">LogUniformPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#LogUniformPrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.LogUniformPrior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightcurve_fitting.models.Prior" title="lightcurve_fitting.models.Prior"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prior</span></code></a></p>
<p>A uniform prior in the logarithm of the parameter, i.e., <span class="math notranslate nohighlight">\(\frac{dP}{dp} \propto \frac{1}{p}\)</span></p>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.LogUniformPrior.logp">
<span class="sig-name descname"><span class="pre">logp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#LogUniformPrior.logp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.LogUniformPrior.logp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.Model">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">Model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#Model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.Model" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>An analytical model, defined by a function and its parameters</p>
<dl class="py property">
<dt class="sig sig-object py" id="lightcurve_fitting.models.Model.axis_labels">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">axis_labels</span></span><a class="headerlink" href="#lightcurve_fitting.models.Model.axis_labels" title="Permalink to this definition">¶</a></dt>
<dd><p>Axis labels for each paramter (including name and unit)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.Model.evaluate">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#Model.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.Model.evaluate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.Model.input_names">
<span class="sig-name descname"><span class="pre">input_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#lightcurve_fitting.models.Model.input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the parameter names</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.Model.log_likelihood">
<span class="sig-name descname"><span class="pre">log_likelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'relative'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#Model.log_likelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.Model.log_likelihood" title="Permalink to this definition">¶</a></dt>
<dd><p>The log of the likelihood function of the model given data contained in <cite>lc</cite> and parameters contained in <cite>p</cite></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>lc</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>Table of broadband photometry including columns “MJD”, “mag”, “dmag”, “filter”</p>
</dd>
<dt><strong>p</strong><span class="classifier">array-like</span></dt><dd><p>Model parameters for which to calculate the likelihood. The first dimension should have the same length as
the number of parameters, or one more if sigma is used.</p>
</dd>
<dt><strong>use_sigma</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, treat the last parameter as an intrinsic scatter parameter that does not get passed to the model</p>
</dd>
<dt><strong>sigma_type</strong><span class="classifier">str, optional</span></dt><dd><p>If ‘relative’ (default), sigma will be in units of the individual photometric uncertainties.
If ‘absolute’, sigma will be in units of the median photometric uncertainty.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>log_likelihood</strong><span class="classifier">float, array-like</span></dt><dd><p>The natural log of the likelihood function. If <cite>p</cite> is 1D, <cite>log_likelihood</cite> is a float. Otherwise, its shape
is determined by the remaining dimensions of <cite>p</cite>.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="lightcurve_fitting.models.Model.nparams">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">nparams</span></span><a class="headerlink" href="#lightcurve_fitting.models.Model.nparams" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of parameters in the model</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.Model.output_quantity">
<span class="sig-name descname"><span class="pre">output_quantity</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'lum'</span></em><a class="headerlink" href="#lightcurve_fitting.models.Model.output_quantity" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantity output by the model: ‘lum’ or ‘flux’</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.Model.units">
<span class="sig-name descname"><span class="pre">units</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[]</span></em><a class="headerlink" href="#lightcurve_fitting.models.Model.units" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the units for each parameter</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.Prior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">Prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#Prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.Prior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.11)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.Prior.logp">
<em class="property"><span class="pre">abstract</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">logp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#Prior.logp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.Prior.logp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">ShockCooling</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#ShockCooling"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightcurve_fitting.models.BaseShockCooling" title="lightcurve_fitting.models.BaseShockCooling"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseShockCooling</span></code></a></p>
<p>The shock cooling model of Sapir &amp; Waxman (<a class="reference external" href="https://doi.org/10.3847/1538-4357/aa64df">https://doi.org/10.3847/1538-4357/aa64df</a>).</p>
<p>This version of the model is written in terms of physical parameters <span class="math notranslate nohighlight">\(v_s, M_\mathrm{env}, f_ρ M, R\)</span>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M_env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_rho_M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#ShockCooling.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate this model at a range of times and filters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_in</strong><span class="classifier">float, array-like</span></dt><dd><p>Time in days</p>
</dd>
<dt><strong>f</strong><span class="classifier">lightcurve_fitting.filter.Filter, array-like</span></dt><dd><p>Filters for which to calculate the model</p>
</dd>
<dt><strong>v_s</strong><span class="classifier">float, array-like</span></dt><dd><p>The shock speed in <span class="math notranslate nohighlight">\(10^{8.5}\)</span> cm/s</p>
</dd>
<dt><strong>M_env</strong><span class="classifier">float, array-like</span></dt><dd><p>The envelope mass in solar masses</p>
</dd>
<dt><strong>f_rho_M</strong><span class="classifier">float, array-like</span></dt><dd><p>The product <span class="math notranslate nohighlight">\(f_ρ M\)</span>, where “<span class="math notranslate nohighlight">\(f_ρ\)</span> is a numerical factor of order unity that depends on the inner
envelope structure” and <span class="math notranslate nohighlight">\(M\)</span> is the ejecta mass in solar masses</p>
</dd>
<dt><strong>R</strong><span class="classifier">float, array-like</span></dt><dd><p>The progenitor radius in <span class="math notranslate nohighlight">\(10^{13}\)</span> cm</p>
</dd>
<dt><strong>t_exp</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>The explosion epoch. Default: 0.</p>
</dd>
<dt><strong>kappa</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>The ejecta opacity in units of the electron scattering opacity (0.34 cm^2/g). Default: 1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_fit</strong><span class="classifier">array-like</span></dt><dd><p>The filtered model light curves</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling.input_names">
<span class="sig-name descname"><span class="pre">input_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['v_\\mathrm{s*}',</span> <span class="pre">'M_\\mathrm{env}',</span> <span class="pre">'f_\\rho</span> <span class="pre">M',</span> <span class="pre">'R',</span> <span class="pre">'t_0']</span></em><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling.input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the parameter names</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling.units">
<span class="sig-name descname"><span class="pre">units</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[&lt;Quantity</span> <span class="pre">3.16227766e+08</span> <span class="pre">cm</span> <span class="pre">/</span> <span class="pre">s&gt;,</span> <span class="pre">Unit(&quot;solMass&quot;),</span> <span class="pre">Unit(&quot;solMass&quot;),</span> <span class="pre">&lt;Quantity</span> <span class="pre">1.e+13</span> <span class="pre">cm&gt;,</span> <span class="pre">Unit(&quot;d&quot;)]</span></em><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling.units" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the units for each parameter</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling2">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">ShockCooling2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#ShockCooling2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling2" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightcurve_fitting.models.BaseShockCooling" title="lightcurve_fitting.models.BaseShockCooling"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseShockCooling</span></code></a></p>
<p>The shock cooling model of Sapir &amp; Waxman (<a class="reference external" href="https://doi.org/10.3847/1538-4357/aa64df">https://doi.org/10.3847/1538-4357/aa64df</a>).</p>
<p>This version of the model is written in terms of scaling parameters <span class="math notranslate nohighlight">\(T_1, L_1, t_\mathrm{tr}\)</span>:</p>
<p><span class="math notranslate nohighlight">\(T(t) = T_1 t^{ε_T}\)</span> and
<span class="math notranslate nohighlight">\(L(t) = L_1 t^{ε_L} \exp\left[-\left(\frac{a t}{t_\mathrm{tr}}\right)^α\right]\)</span></p>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling2.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">L_1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_tr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#ShockCooling2.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling2.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate this model at a range of times and filters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_in</strong><span class="classifier">float, array-like</span></dt><dd><p>Time in days</p>
</dd>
<dt><strong>f</strong><span class="classifier">lightcurve_fitting.filter.Filter, array-like</span></dt><dd><p>Filters for which to calculate the model</p>
</dd>
<dt><strong>T_1</strong><span class="classifier">float, array-like</span></dt><dd><p>The blackbody temperature 1 day after explosion in kilokelvins</p>
</dd>
<dt><strong>L_1</strong><span class="classifier">float, array-like</span></dt><dd><p>The approximate blackbody luminosity 1 day after explosion in <span class="math notranslate nohighlight">\(10^{42}\)</span> erg/s</p>
</dd>
<dt><strong>t_tr</strong><span class="classifier">float, array-like</span></dt><dd><p>The time at which the envelope becomes transparent in rest-frame days</p>
</dd>
<dt><strong>t_exp</strong><span class="classifier">float, array-like</span></dt><dd><p>The explosion epoch</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_fit</strong><span class="classifier">array-like</span></dt><dd><p>The filtered model light curves</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling2.input_names">
<span class="sig-name descname"><span class="pre">input_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['T_1',</span> <span class="pre">'L_1',</span> <span class="pre">'t_\\mathrm{tr}',</span> <span class="pre">'t_0']</span></em><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling2.input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the parameter names</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling2.t_max">
<span class="sig-name descname"><span class="pre">t_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#ShockCooling2.t_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling2.t_max" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum time at which the model is valid</p>
<p><span class="math notranslate nohighlight">\(t_\mathrm{max} = \left(\frac{8.12\,\mathrm{kK}}{T_1}\right)^{1/(2 ε_1 - 0.5)} + t_\mathrm{exp}\)</span></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling2.t_min">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#ShockCooling2.t_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling2.t_min" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum time at which the model is valid</p>
<p>This expression cannot be translated to the parameters of <a class="reference internal" href="#lightcurve_fitting.models.ShockCooling2" title="lightcurve_fitting.models.ShockCooling2"><code class="xref py py-class docutils literal notranslate"><span class="pre">ShockCooling2</span></code></a></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling2.units">
<span class="sig-name descname"><span class="pre">units</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[Unit(&quot;kK&quot;),</span> <span class="pre">&lt;Quantity</span> <span class="pre">1.e+42</span> <span class="pre">erg</span> <span class="pre">/</span> <span class="pre">s&gt;,</span> <span class="pre">Unit(&quot;d&quot;),</span> <span class="pre">Unit(&quot;d&quot;)]</span></em><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling2.units" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the units for each parameter</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling3">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">ShockCooling3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">lc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">redshift</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">RW</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#ShockCooling3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling3" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightcurve_fitting.models.BaseShockCooling" title="lightcurve_fitting.models.BaseShockCooling"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseShockCooling</span></code></a></p>
<p>The shock cooling model of Sapir &amp; Waxman (<a class="reference external" href="https://doi.org/10.3847/1538-4357/aa64df">https://doi.org/10.3847/1538-4357/aa64df</a>).</p>
<p>This version of the model is written in terms of physical parameters <span class="math notranslate nohighlight">\(v_s, M_\mathrm{env}, f_ρ M, R\)</span> and
includes distance <span class="math notranslate nohighlight">\(d_L\)</span> and reddening <span class="math notranslate nohighlight">\(E(B-V)\)</span> as free parameters.</p>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling3.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">t_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">v_s</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">M_env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">f_rho_M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dist</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">t_exp</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#ShockCooling3.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling3.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate this model at a range of times and filters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>t_in</strong><span class="classifier">float, array-like</span></dt><dd><p>Time in days</p>
</dd>
<dt><strong>f</strong><span class="classifier">lightcurve_fitting.filter.Filter, array-like</span></dt><dd><p>Filters for which to calculate the model</p>
</dd>
<dt><strong>v_s</strong><span class="classifier">float, array-like</span></dt><dd><p>The shock speed in <span class="math notranslate nohighlight">\(10^{8.5}\)</span> cm/s</p>
</dd>
<dt><strong>M_env</strong><span class="classifier">float, array-like</span></dt><dd><p>The envelope mass in solar masses</p>
</dd>
<dt><strong>f_rho_M</strong><span class="classifier">float, array-like</span></dt><dd><p>The product <span class="math notranslate nohighlight">\(f_ρ M\)</span>, where “<span class="math notranslate nohighlight">\(f_ρ\)</span> is a numerical factor of order unity that depends on the inner
envelope structure” and <span class="math notranslate nohighlight">\(M\)</span> is the ejecta mass in solar masses</p>
</dd>
<dt><strong>R</strong><span class="classifier">float, array-like</span></dt><dd><p>The progenitor radius in <span class="math notranslate nohighlight">\(10^{13}\)</span> cm</p>
</dd>
<dt><strong>dist</strong><span class="classifier">float, array-like</span></dt><dd><p>The luminosity distance in Mpc</p>
</dd>
<dt><strong>ebv</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>The reddening <span class="math notranslate nohighlight">\(E(B-V)\)</span> to apply to the blackbody spectrum before integration. Default: 0.</p>
</dd>
<dt><strong>t_exp</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>The explosion epoch. Default: 0.</p>
</dd>
<dt><strong>kappa</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>The ejecta opacity in units of the electron scattering opacity (0.34 cm^2/g). Default: 1.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_fit</strong><span class="classifier">array-like</span></dt><dd><p>The filtered model light curves</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling3.input_names">
<span class="sig-name descname"><span class="pre">input_names</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">['v_\\mathrm{s*}',</span> <span class="pre">'M_\\mathrm{env}',</span> <span class="pre">'f_\\rho</span> <span class="pre">M',</span> <span class="pre">'R',</span> <span class="pre">'d_L',</span> <span class="pre">'E(B-V)',</span> <span class="pre">'t_0']</span></em><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling3.input_names" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the parameter names</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling3.output_quantity">
<span class="sig-name descname"><span class="pre">output_quantity</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'flux'</span></em><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling3.output_quantity" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantity output by the model: ‘lum’ or ‘flux’</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling3.t_max">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_max</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#ShockCooling3.t_max"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling3.t_max" title="Permalink to this definition">¶</a></dt>
<dd><p>The maximum time at which the model is valid</p>
<p><span class="math notranslate nohighlight">\(t_\mathrm{max} = (7.4\,\mathrm{d}) \left(\frac{R}{κ}\right)^{0.55} + t_\mathrm{exp}\)</span> (Eq. 24)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling3.t_min">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">t_min</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kappa</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#ShockCooling3.t_min"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling3.t_min" title="Permalink to this definition">¶</a></dt>
<dd><p>The minimum time at which the model is valid</p>
<p><span class="math notranslate nohighlight">\(t_\mathrm{min} = (0.2\,\mathrm{d}) \frac{R}{v_s}
\max\left[0.5, \frac{R^{0.4}}{(f_ρ M κ)^{0.2} v_s^{-0.7}}\right] + t_\mathrm{exp}\)</span> (Eq. 17)</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="lightcurve_fitting.models.ShockCooling3.units">
<span class="sig-name descname"><span class="pre">units</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">[&lt;Quantity</span> <span class="pre">3.16227766e+08</span> <span class="pre">cm</span> <span class="pre">/</span> <span class="pre">s&gt;,</span> <span class="pre">Unit(&quot;solMass&quot;),</span> <span class="pre">Unit(&quot;solMass&quot;),</span> <span class="pre">&lt;Quantity</span> <span class="pre">1.e+13</span> <span class="pre">cm&gt;,</span> <span class="pre">Unit(&quot;Mpc&quot;),</span> <span class="pre">Unit(&quot;mag&quot;),</span> <span class="pre">Unit(&quot;d&quot;)]</span></em><a class="headerlink" href="#lightcurve_fitting.models.ShockCooling3.units" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of the units for each parameter</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="lightcurve_fitting.models.UniformPrior">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">UniformPrior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p_min</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#UniformPrior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.UniformPrior" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#lightcurve_fitting.models.Prior" title="lightcurve_fitting.models.Prior"><code class="xref py py-class docutils literal notranslate"><span class="pre">Prior</span></code></a></p>
<p>A uniform prior in the parameter, i.e., <span class="math notranslate nohighlight">\(\frac{dP}{dp} \propto 1\)</span></p>
<dl class="py method">
<dt class="sig sig-object py" id="lightcurve_fitting.models.UniformPrior.logp">
<span class="sig-name descname"><span class="pre">logp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">p</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#UniformPrior.logp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.UniformPrior.logp" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.models.blackbody_to_filters">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">blackbody_to_filters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">z</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ebv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#blackbody_to_filters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.blackbody_to_filters" title="Permalink to this definition">¶</a></dt>
<dd><p>The average spectral luminosity density (<span class="math notranslate nohighlight">\(L_ν\)</span>) of a blackbody as observed through one or more filters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filters</strong><span class="classifier">lightcurve_fitting.filters.Filter, array-like</span></dt><dd><p>One or more broadband filters</p>
</dd>
<dt><strong>T</strong><span class="classifier">float, array-like</span></dt><dd><p>Blackbody temperatures in kilokelvins</p>
</dd>
<dt><strong>R</strong><span class="classifier">float, array-like</span></dt><dd><p>Blackbody radii in units of 1000 solar radii</p>
</dd>
<dt><strong>z</strong><span class="classifier">float</span></dt><dd><p>Redshift between the blackbody source and the observed filters</p>
</dd>
<dt><strong>cutoff_freq</strong><span class="classifier">float, optional</span></dt><dd><p>Cutoff frequency (in terahertz) for a modified blackbody spectrum (see <a class="reference external" href="https://doi.org/10.3847/1538-4357/aa9334">https://doi.org/10.3847/1538-4357/aa9334</a>)</p>
</dd>
<dt><strong>ebv</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Selective extinction E(B-V) in magnitudes, evaluated using a Fitzpatrick (1999) extinction law with R_V=3.1.
Its shape must be broadcastable to T and R. Default: 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>y_fit</strong><span class="classifier">float, array-like</span></dt><dd><p>The average spectral luminosity density in each filter in watts per hertz</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.models.format_unit">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">format_unit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">unit</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#format_unit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.format_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Use LaTeX to format a physical unit, which may consist of an order of magnitude times a base unit</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>unit</strong><span class="classifier">astropy.units.Unit, astropy.units.Quantity</span></dt><dd><p>The unit to format</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>unit_str</strong><span class="classifier">str</span></dt><dd><p>Formatted unit</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.models.planck">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">planck</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dT</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dR</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#planck"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.planck" title="Permalink to this definition">¶</a></dt>
<dd><p>The Planck spectrum for a blackbody source, including propagation of uncertainties</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nu</strong><span class="classifier">float, array-like</span></dt><dd><p>Frequency in terahertz</p>
</dd>
<dt><strong>T</strong><span class="classifier">float, array-like</span></dt><dd><p>Temperature in kilokelvins</p>
</dd>
<dt><strong>R</strong><span class="classifier">float, array-like</span></dt><dd><p>Radius in units of 1000 solar radii</p>
</dd>
<dt><strong>dT</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Uncertainty in the temperature in kilokelvins</p>
</dd>
<dt><strong>dR</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>Uncertainty in the radius in units of 1000 solar radii</p>
</dd>
<dt><strong>cov</strong><span class="classifier">float, array-like, optional</span></dt><dd><p>The covariance between the temperature and radius</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>Lnu</strong><span class="classifier">float, array-like</span></dt><dd><p>The spectral luminosity density (<span class="math notranslate nohighlight">\(L_ν\)</span>) of the source in watts per hertz</p>
</dd>
<dt><strong>dLnu</strong><span class="classifier">float, array-like</span></dt><dd><p>The uncertainty in the spectral luminosity density in watts per hertz</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.models.planck_fast">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">planck_fast</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">nu</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">T</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_freq</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#planck_fast"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.planck_fast" title="Permalink to this definition">¶</a></dt>
<dd><p>The Planck spectrum for a blackbody source</p>
<p><span class="math notranslate nohighlight">\(L_ν = 4 π R^2 \frac{2 π h ν^3 c^{-2}}{\exp(h ν / k_B T) - 1}\)</span></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>nu</strong><span class="classifier">float, array-like</span></dt><dd><p>Frequency in terahertz</p>
</dd>
<dt><strong>T</strong><span class="classifier">float, array-like</span></dt><dd><p>Temperature in kilokelvins</p>
</dd>
<dt><strong>R</strong><span class="classifier">float, array-like</span></dt><dd><p>Radius in units of 1000 solar radii</p>
</dd>
<dt><strong>cutoff_freq</strong><span class="classifier">float, optional</span></dt><dd><p>Cutoff frequency (in terahertz) for a modified blackbody spectrum (see <a class="reference external" href="https://doi.org/10.3847/1538-4357/aa9334">https://doi.org/10.3847/1538-4357/aa9334</a>)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>float, array-like</dt><dd><p>The spectral luminosity density (<span class="math notranslate nohighlight">\(L_ν\)</span>) of the source in watts per hertz</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.models.power">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.models.</span></span><span class="sig-name descname"><span class="pre">power</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">base</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/models.html#power"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.models.power" title="Permalink to this definition">¶</a></dt>
<dd><p>Power function that returns zero for any nonpositive base</p>
</dd></dl>

</section>
<section id="module-lightcurve_fitting.speccal">
<span id="lightcurve-fitting-speccal-module"></span><h2>lightcurve_fitting.speccal module<a class="headerlink" href="#module-lightcurve_fitting.speccal" title="Permalink to this heading">¶</a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.speccal.calibrate_spectra">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.speccal.</span></span><span class="sig-name descname"><span class="pre">calibrate_spectra</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">spectra</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">lc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">filters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subtract_percentile</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_extrapolate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/speccal.html#calibrate_spectra"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.speccal.calibrate_spectra" title="Permalink to this definition">¶</a></dt>
<dd><p>Calibrate a set of spectra to an observed broadband light curve.</p>
<p>Each calibrated spectrum is saved to a text file that corresponds to the original filename prefixed by <code class="docutils literal notranslate"><span class="pre">photcal_</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>spectra</strong><span class="classifier">list</span></dt><dd><p>List of filenames containing the spectra</p>
</dd>
<dt><strong>lc</strong><span class="classifier">lightcurve_fitting.lightcurve.LC</span></dt><dd><p>Photometry table containing the observed light curve</p>
</dd>
<dt><strong>filters</strong><span class="classifier">list, optional</span></dt><dd><p>Only use this subset of filters for calibration</p>
</dd>
<dt><strong>order</strong><span class="classifier">int, optional</span></dt><dd><p>Polynomial order for the calibration function. Default: 0 (constant factor)</p>
</dd>
<dt><strong>subtract_percentile</strong><span class="classifier">float, optional</span></dt><dd><p>Subtract flux corresponding to this percentile of the spectrum before calibration. Default: no subtraction</p>
</dd>
<dt><strong>max_extrapolate</strong><span class="classifier">float, optional</span></dt><dd><p>Assume constant flux in a filter for this many days after the last observed point. Default: 1 day.</p>
</dd>
<dt><strong>show</strong><span class="classifier">bool, optional</span></dt><dd><p>Plot the observed light curve and the uncalibrated and calibrated spectra, and ask whether to save the results</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>fig</strong><span class="classifier">matplotlib.pyplot.Figure</span></dt><dd><p>If <cite>show=True</cite>, the Figure object is returned</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.speccal.convert_spectrum_units">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.speccal.</span></span><span class="sig-name descname"><span class="pre">convert_spectrum_units</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">wl</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flux</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hdr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_bunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'erg</span> <span class="pre">/</span> <span class="pre">(Angstrom</span> <span class="pre">cm2</span> <span class="pre">s)'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default_cunit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Angstrom'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/speccal.html#convert_spectrum_units"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.speccal.convert_spectrum_units" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert a spectrum to standard units, if information is available in the header to establish units (BUNIT &amp; CUNIT1)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>wl: array-like</strong></dt><dd><p>Input wavelengths</p>
</dd>
<dt><strong>flux: array-like</strong></dt><dd><p>Input fluxes</p>
</dd>
<dt><strong>hdr: dict-like</strong></dt><dd><p>Metadata from which to determine the units of wl and flux</p>
</dd>
<dt><strong>default_bunit: str, optional</strong></dt><dd><p>Units of the output flux. Default: ‘erg / (Angstrom cm2 s)’</p>
</dd>
<dt><strong>default_cunit: str, optional</strong></dt><dd><p>Units of the output wavelengths. Default: ‘Angstrom’</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt>wl: numpy.ndarray</dt><dd><p>Input wavelengths converted to <cite>default_cunit</cite></p>
</dd>
<dt>flux: numpy.ndarray</dt><dd><p>Input fluxes converted to <cite>default_bunit</cite></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.speccal.create_wiserep_tsv">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.speccal.</span></span><span class="sig-name descname"><span class="pre">create_wiserep_tsv</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">specpaths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wiserep_dir</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/speccal.html#create_wiserep_tsv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.speccal.create_wiserep_tsv" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares a TSV file for uploading spectra to WISeREP (see <a class="reference external" href="https://www.wiserep.org/content/wiserep-getting-started">https://www.wiserep.org/content/wiserep-getting-started</a>).</p>
<p>Also copies all the spectrum files to a single directory, and converts any FITS files to ASCII.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>specpaths: list</strong></dt><dd><p>List of paths to the spectrum files. Optionally, data quality can be specified in a tuple, e.g.,
[(filename1.fits, 3), (filename2.txt, 2), …], where the second element is 1 (low), 2 (medium), or 3 (high).</p>
</dd>
<dt><strong>wiserep_dir: str</strong></dt><dd><p>Directory in which to collect the spectra. If it already exists, it will be deleted and remade.
The TSV file will be saved alongside this directory using the same name but with a ‘.tsv’ extension.</p>
</dd>
<dt><strong>verbose: bool, optional</strong></dt><dd><p>If True, print a message when any file is copied or created.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.speccal.readOSCspec">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.speccal.</span></span><span class="sig-name descname"><span class="pre">readOSCspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filepath</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/speccal.html#readOSCspec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.speccal.readOSCspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Read spectra from a JSON file in the Open Astronomy Catalog schema (<a class="reference external" href="https://github.com/astrocatalogs/schema">https://github.com/astrocatalogs/schema</a>)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filepath</strong><span class="classifier">str</span></dt><dd><p>Path to the JSON file containing the spectra</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>filenames</strong><span class="classifier">list</span></dt><dd><p>List of filenames corresponding to each spectrum</p>
</dd>
<dt><strong>times</strong><span class="classifier">list</span></dt><dd><p>List of <a class="reference external" href="https://docs.astropy.org/en/stable/api/astropy.time.Time.html#astropy.time.Time" title="(in Astropy v5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.time.Time</span></code></a> when each spectrum was observed</p>
</dd>
<dt><strong>tel</strong><span class="classifier">list</span></dt><dd><p>List of telescope names (if given) where each spectrum was observed</p>
</dd>
<dt><strong>inst</strong><span class="classifier">list</span></dt><dd><p>List of instrument names (if given) with which each spectrum was observed</p>
</dd>
<dt><strong>wl</strong><span class="classifier">list</span></dt><dd><p>List of wavelength arrays for each spectrum</p>
</dd>
<dt><strong>fx</strong><span class="classifier">list</span></dt><dd><p>List of flux arrays for each spectrum</p>
</dd>
<dt><strong>scales</strong><span class="classifier">list</span></dt><dd><p>List of scaling factors for each spectrum (all ones for the OSC)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.speccal.readfitsspec">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.speccal.</span></span><span class="sig-name descname"><span class="pre">readfitsspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ext</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/speccal.html#readfitsspec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.speccal.readfitsspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a spectrum from a FITS file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>filename</strong><span class="classifier">str</span></dt><dd><p>Filename from which to read the spectrum</p>
</dd>
<dt><strong>header</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, also return the FITS header</p>
</dd>
<dt><strong>ext</strong><span class="classifier">int, str, optional</span></dt><dd><p>FITS extension number or name in which the spectrum is stored</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>wl</strong><span class="classifier">array-like</span></dt><dd><p>Wavelengths, typically in ångströms</p>
</dd>
<dt><strong>flux</strong><span class="classifier">array-like</span></dt><dd><p>Observed fluxes in erg / (s cm2 angstrom), if units are identifiable</p>
</dd>
<dt><strong>hdr</strong><span class="classifier">astropy.io.fits.header.Header, optional</span></dt><dd><p>FITS header, returned if <code class="docutils literal notranslate"><span class="pre">header=True</span></code></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.speccal.readspec">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.speccal.</span></span><span class="sig-name descname"><span class="pre">readspec</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/speccal.html#readspec"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.speccal.readspec" title="Permalink to this definition">¶</a></dt>
<dd><p>Read a spectrum from a FITS or ASCII file and try to identify where and when it was observed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><dl class="simple">
<dt><strong>f</strong><span class="classifier">str</span></dt><dd><p>Filename from which to read the spectrum</p>
</dd>
<dt><strong>verbose</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, print the date and filename of the spectrum</p>
</dd>
<dt><strong>return_header</strong><span class="classifier">bool, optional</span></dt><dd><p>If True, return the full header as an additional return value</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><dl class="simple">
<dt><strong>x</strong><span class="classifier">array-like</span></dt><dd><p>Wavelengths, typically in ångströms</p>
</dd>
<dt><strong>y</strong><span class="classifier">array-like</span></dt><dd><p>Fluxes in erg / (s cm2 angstrom), if units are identifiable</p>
</dd>
<dt><strong>date</strong><span class="classifier">astropy.time.Time</span></dt><dd><p>Time at which the spectrum was observed, if identifiable (otherwise <code class="docutils literal notranslate"><span class="pre">None</span></code>)</p>
</dd>
<dt><strong>telescope</strong><span class="classifier">str</span></dt><dd><p>Name of the telescope at which the spectrum was observed, if identifiable (otherwise <code class="docutils literal notranslate"><span class="pre">''</span></code>)</p>
</dd>
<dt>instrument: str</dt><dd><p>Name of the instrument used to observe the spectrum, if identifiable (otherwise <code class="docutils literal notranslate"><span class="pre">''</span></code>)</p>
</dd>
<dt><strong>hdr</strong><span class="classifier">dict-like</span></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">return_header=True</span></code>, metadata is returned as a FITS header or dictionary (for ASCII files)</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.speccal.remove_duplicate_wcs">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.speccal.</span></span><span class="sig-name descname"><span class="pre">remove_duplicate_wcs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdr</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keep_number</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/speccal.html#remove_duplicate_wcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.speccal.remove_duplicate_wcs" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove duplicate world coordinate system header keywords from a <a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.io.fits.header.Header</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="lightcurve_fitting.speccal.removebadcards">
<span class="sig-prename descclassname"><span class="pre">lightcurve_fitting.speccal.</span></span><span class="sig-name descname"><span class="pre">removebadcards</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">hdr</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/lightcurve_fitting/speccal.html#removebadcards"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#lightcurve_fitting.speccal.removebadcards" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove problematic entries from a <a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/api/headers.html#astropy.io.fits.Header" title="(in Astropy v5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.io.fits.header.Header</span></code></a></p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="usage.html" class="btn btn-neutral float-left" title="Usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="release-history.html" class="btn btn-neutral float-right" title="Release History" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Griffin Hosseinzadeh.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>